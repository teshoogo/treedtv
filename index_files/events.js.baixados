/*! For license information please see events.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.events=t():e.events=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.PRODUCTION=t.BROWSER_PREFIXS=t.SDK_VERSION=t.API=t.KWAI_SESSION_ID=t.REPORT_TYPE=t.EVENT_NAME_FORMAT=t.EVENT_NAME=t.PAGE_VIEW_EVENT_NAME=t.UNKNOWN_EVENT=t.PAGE_ID=t.SESSION_ID=t.KWAI_Q=t.KWAI_ANALYTICS_OBJECT=t.KWAI_CALLBACK_SOURCE=t.KWAI_CALLBACK_SESSION_KEY=t.KWAI_PIXEL_ID=t.KWAI_CALLBACK=t.KWAI_TEST_ID=void 0,t.KWAI_TEST_ID="ks_px_test",t.KWAI_CALLBACK="click_id",t.KWAI_PIXEL_ID="pixel_id",t.KWAI_CALLBACK_SESSION_KEY="kwai_adInfo",t.KWAI_CALLBACK_SOURCE="kwai_adInfo_source",t.KWAI_ANALYTICS_OBJECT="KwaiAnalyticsObject",t.KWAI_Q="kwaiq",t.SESSION_ID="sessionId",t.PAGE_ID="pageId",t.UNKNOWN_EVENT="UNKNOWN",t.PAGE_VIEW_EVENT_NAME="pageView",t.EVENT_NAME={pageView:"EVENT_PAGE_VIEW",addPaymentInfo:"EVENT_ADD_PAYMENT_INFO",addToCart:"EVENT_ADD_TO_CART",buttonClick:"EVENT_BUTTON_CLICK",purchase:"EVENT_PURCHASE",contentView:"EVENT_CONTENT_VIEW",download:"EVENT_DOWNLOAD",formSubmit:"EVENT_FORM_SUBMIT",initiatedCheckout:"EVENT_INITIATED_CHECKOUT",contact:"EVENT_CONTACT",placeOrder:"EVENT_PLACE_ORDER",search:"EVENT_SERACH",completeRegistration:"EVENT_COMPLETE_REGISTRATION",addToWishlist:"EVENT_ADD_TO_WISHLIST",subscribe:"EVENT_SUBSCRIBE",firstDeposit:"EVENT_FIRST_DEPOSIT",creditApproval:"EVENT_CREDIT_APPROVAL",loanApplication:"EVENT_LOAN_APPLICATION",loanCredit:"EVENT_LOAN_CREDIT",loanDisbursal:"EVENT_LOAN_DISBURSAL",creditCardApplication:"EVENT_CREDIT_CARD_APPLICATION"},t.EVENT_NAME_FORMAT={EVENT_PAGE_VIEW:"pageView",EVENT_ADD_PAYMENT_INFO:"addPaymentInfo",EVENT_ADD_TO_CART:"addToCart",EVENT_BUTTON_CLICK:"buttonClick",EVENT_PURCHASE:"purchase",EVENT_CONTENT_VIEW:"contentView",EVENT_DOWNLOAD:"download",EVENT_FORM_SUBMIT:"formSubmit",EVENT_INITIATED_CHECKOUT:"initiatedCheckout",EVENT_CONTACT:"contact",EVENT_PLACE_ORDER:"placeOrder",EVENT_SERACH:"search",EVENT_COMPLETE_REGISTRATION:"completeRegistration",EVENT_ADD_TO_WISHLIST:"addToWishlist",EVENT_SUBSCRIBE:"subscribe",EVENT_FIRST_DEPOSIT:"firstDeposit",EVENT_CREDIT_APPROVAL:"creditApproval",EVENT_LOAN_APPLICATION:"loanApplication",EVENT_LOAN_CREDIT:"loanCredit",EVENT_LOAN_DISBURSAL:"loanDisbursal",EVENT_CREDIT_CARD_APPLICATION:"creditCardApplication"},function(e){e.TRACK="track",e.TEST_TRACK="test_track"}(i=t.REPORT_TYPE||(t.REPORT_TYPE={})),t.KWAI_SESSION_ID="kwai_session_id",t.API=((r={})[i.TRACK]="https://www.adsnebula.com/log/common",r[i.TEST_TRACK]="",r.GET_PIXEL="https://api.mythad.com/rest/n/adintl/ad/getPixelConfig",r),t.SDK_VERSION="1.1.3",t.BROWSER_PREFIXS=["","webkit","WebKit","moz","Moz","ms","MS","o","O"],t.PRODUCTION=!0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toHump=t.getUrlIn=t.writeVal=t.readVal=t.getRandom=t.getValFromCookieByName=t.getDomain=t.getSearchParams=void 0;var r=n(11);Object.defineProperty(t,"getSearchParams",{enumerable:!0,get:function(){return r.getSearchParams}});var i=n(12);Object.defineProperty(t,"getDomain",{enumerable:!0,get:function(){return i.getDomain}});var a=n(14);Object.defineProperty(t,"getValFromCookieByName",{enumerable:!0,get:function(){return a.getValFromCookieByName}});var o=n(15);Object.defineProperty(t,"getRandom",{enumerable:!0,get:function(){return o.getRandom}});var s=n(16);Object.defineProperty(t,"readVal",{enumerable:!0,get:function(){return s.readVal}}),Object.defineProperty(t,"writeVal",{enumerable:!0,get:function(){return s.writeVal}});var c=n(17);Object.defineProperty(t,"getUrlIn",{enumerable:!0,get:function(){return c.getUrlIn}});var u=n(18);Object.defineProperty(t,"toHump",{enumerable:!0,get:function(){return u.toHump}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerTypesName=void 0,t.LoggerTypesName={successConfig:"successConfig",errConfig:"errConfig",successBridge:"successBridge",errBridge:"errBridge",errBridgeForUnPixel:"errBridgeForNotPixelAd",errMatchPixelId:"errMatchPixelId",errPixelId:"errPixelId",errClickId:"errClickId",errUp:"errUp",successUp:"successUp",successUpForOther:"successUpForOther",wAndc:"windowAndcookie"}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.logWC=t.getWdata=t.logUp=t.logErr=t.logFMP=void 0;var i=n(27),a=r(n(28)),o=n(2),s=new i.Weblog({env:"oversea",plugins:[new a.default({projectId:"5b88a5135h",resourceSampling:1,sampling:1})]});t.logFMP=function(){s.plugins.radar.fmp()};t.logErr=function(e){s.plugins.radar.event(e)};t.logUp=function(e){s.plugins.radar.event(e)};t.getWdata=function(e,t){return e.ymcart_goods_id||e.ymcart_countrys||e.ymcart_data_id||e.ymcart_store_id||t.includes("ymcart")?"shopyy":e.SHOPLAZZA||e.SHOPLAZZA_APPS_COMMON||e.SHOP_PARAMS||e.Shoplazza||t.includes("shoplazza")?"shoplazza":e.Shopline?"shopline":e.Shopify||e.shopifySpbJsonp||e.ShopifyAnalytics||e.ShopifyPaypalV4VisibilityTracking||t.includes("shopify")?"shopify":e.wp?"wordpress":window.location.href.includes("aliexpress")||e.AES||e.ali_analytics?"aliexpress":void 0};t.logWC=function(){var e=(0,t.getWdata)(window,document.cookie);s.plugins.radar.event({name:o.LoggerTypesName.wAndc,extra_info:JSON.stringify({trilateralDate:e||"none"})})}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Jt}));var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function i(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function a(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))}function o(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function s(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}var c=[{namespace:"system",name:"getDeviceInfo"},{namespace:"system",name:"getAppInfo"},{namespace:"system",name:"getNetworkType"},{namespace:"webview",name:"open"},{namespace:"webview",name:"getLaunchParams"},{namespace:"webview",name:"close"},{namespace:"webview",name:"backOrClose"},{namespace:"tool",name:"canIUse"},{namespace:"tool",name:"sendRadarLog"},{namespace:"tool",name:"checkAppInstalled"},{namespace:"tool",name:"launchApp"},{namespace:"ui",name:"setTopBarStyle"},{namespace:"ui",name:"setTitle"},{namespace:"ui",name:"setTopBarButton"},{namespace:"ui",name:"removeTopBarButton"},{namespace:"ui",name:"setSlideBackBehavior"},{namespace:"ui",name:"setPhysicalBackButtonBehavior"},{namespace:"ui",name:"showLoading"},{namespace:"ui",name:"hideLoading"},{namespace:"ui",name:"showToast"},{namespace:"ui",name:"showDialog"},{namespace:"event",name:"addEventListener"},{namespace:"event",name:"removeEventListener"},{namespace:"event",name:"dispatchEvent"}],u=navigator.userAgent.indexOf(" Android ")>-1;function l(e,t){return c.filter((function(n){return n.namespace==e&&n.name==t})).length>0}var d={"tool.checkAppInstalled":{before:function(e){return{identifier:e[u?"android":"ios"]}}}},p=Number.MAX_SAFE_INTEGER||9007199254740991,f=!1,h=1,m=v();function v(){var e=""+p,t=Number(e.slice(0,3))-100,n=Math.floor(Math.random()*t),r=""+Date.now(),i=r.slice(r.length-9),a=new Array(e.length-12).fill(0).join("");return Number(""+n+i+a)}function g(e){var t=function(e){var t=m+h++;for(;f||e&&e[t];)t=m+h++;return t}(e);return t>=p?(f=!0,h=1,m=v(),g()):t}function y(e){return g(e)}function _(e){return JSON.parse(JSON.stringify(e))}function w(e,t){var n,r=this;return void 0===t&&(t=300),function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];clearTimeout(n),n=setTimeout((function(){e.apply(r,i)}),t)}}function b(e,t){void 0===e&&(e=""),void 0===t&&(t="");for(var n=e.split("."),r=t.split("."),i=0;i<r.length;i++){if(n[i]!==r[i])return(isNaN(Number(n[i]))?0:Number(n[i]))-(isNaN(Number(r[i]))?0:Number(r[i]))}return 0}var S=null;function k(){return S}function E(e,t){return a(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return[4,k().bridge("tool","canIUse",{namespace:e,name:t})];case 1:return[2,"1"==(n=r.sent()).result&&n.canUse]}}))}))}function x(e){return void 0===e&&(e=""),e.includes("Android")||e.includes("Adr")?"android":e.includes("iPhone")||e.includes("iPad")?"ios":"else"}var O=0;var P="too_performance_";var T,I,C="event_";function L(e){return 0==e.indexOf(C)}var A=/Kwai/.test(navigator.userAgent)?void 0===(T=(navigator.userAgent.match(/Kwai\/([\d+.*]+)/)||[])[1])?"":T:void 0===(I=(navigator.userAgent.match(/ksNebula\/([\d+.*]+)/)||[])[1])?"":I,N=!A||b(A,"10.1.30")>=0;function R(){return 0==A.indexOf("9.9.20")}var D=!!window.__yodaBridge__,j=!D;function M(){return navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)}var U,B,K,V={};function W(e){var t=V[e];return Object.keys((null==t?void 0:t.eventRecord)||{}).length>0}!function(e){e.start="start",e.callNative="callNative",e.callbackFromNativeSuccess="callbackFromNativeSuccess",e.callbackFromNativeFail="callbackFromNativeFail",e.callbackFromYoda="callbackFromYoda",e.callbackError="callbackError"}(U||(U={})),function(e){e[e.invoke=0]="invoke",e[e.callback=1]="callback",e[e.event=2]="event"}(B||(B={})),function(e){e.ok="1",e.undefinedCallback="201",e.bridge500="500",e.bridge404="404"}(K||(K={}));var F,q=[],J=0;function H(){D?window.__yodaBridge__.invoke("tool","sendPerformanceLog",JSON.stringify({data:q}),P+y()):q.forEach((function(e,t){})),q.length=0}var z=w((function(){H()}),1e3);function Y(e,t){if(!function(e){return["canIUse","getApiList"].indexOf(e.name)>-1}(e)){var n=Date.now().toString();return(F||(F=new Promise((function(e){var t,n;if(0==J)if(null===(t=window.__yodaCommonDataObject__)||void 0===t?void 0:t.sampleData){if("string"==typeof window.__yodaCommonDataObject__.sampleData)try{window.__yodaCommonDataObject__.sampleData=JSON.parse(window.__yodaCommonDataObject__.sampleData)}catch(e){window.__yodaCommonDataObject__.sampleData={}}J=(null===(n=window.__yodaCommonDataObject__.sampleData)||void 0===n?void 0:n.bridgeHit)?1:2,e(1==J)}else k().bridge("webview","getPageLoadData",{},(function(t){var n=t.result,r=t.sampleData;J=1==n&&(null==r?void 0:r.bridgeHit)?1:2,e(1==J)}));else e(1==J)}))),F).then((function(r){r&&(q.push(function(e,t,n){var r={key:"bridge",value:{},dimension:{api:e.name,namespace:e.namespace},event_client_timestamp:t,event_trigger_source:"H5",task_identifier:e.callbackId,is_task_event:!0,task_status:""};switch(e.type){case B.invoke:r.value.h5_invoke_bridge_time=t,r.task_status="START";break;case B.callback:r.value.h5_receive_callback_time=t,r.value.h5_invoke_bridge_time=n,r.dimension.result_type=e.resultCode,r.dimension.result_type&&(r.dimension.result_type=r.dimension.result_type.toString()),r.dimension.error_msg=e.errorMsg,r.task_status="END";break;case B.event:r.task_status="SUCCESS",delete r.dimension.api,delete r.dimension.namespace,r.dimension.event=""}return r}(e,n,t)),q.length>=30?H():z())})),n}}var G=navigator.userAgent,Q=document.cookie;function X(e){var t={};return G.split(" ").forEach((function(e){var n=e.split("/");t[n[0]]=n[1]})),t[e]?t[e]:t}function $(){if(-1!==G.indexOf("Android"))return"WebView";if(-1!==G.indexOf("iPhone")){var e=X();return e.Yoda&&"WK"===e.WebViewType?"YodaWKWebView":e.Yoda||"WKWebView"!==e.WebView?"UIWebView":"WKWebView"}return""}function Z(e){var t=Q.match(new RegExp("(^| )"+e+"=([^;]+)"));return t?t[2]:""}function ee(e,t,n){void 0===t&&(t={}),void 0===n&&(n=0);var i=(new Date).getTime()-n;this.bridge("tool","sendRadarLog",{removeStashedLog:[],sendImmediate:!0,customData:{project_id:e||"yoda_kpn_"+Z("kpn"),url_package:{page_type:2,page:location.href,params:"",identity:Z("did")},data:[{key:"event",value:{duration:n&&i},dimension:r({yoda_version:X("Yoda")||"",webview_type:$()},t)}]}})}var te={},ne={pushMQ:function(e,t,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var r,i=n?C+y(r):y(te),a=e?{isMulti:!0,resolve:t,promise:new Promise((function(){}))}:function(e){var t,n=new Promise((function(e){t=e}));return e&&(n=n.then(e,e)),{isMulti:!1,resolve:t,promise:n}}(t);return a.traceId=String(i),te[i]=a,a},removeMQ:function(e){te[e]=void 0},create:function(e,t,n,r){void 0===n&&(n=!1);var i=this.pushMQ(n,r);i.namespace=e,i.name=t;var a=Y({namespace:e,name:t,type:B.invoke,callbackId:i.traceId});return te[i.traceId].startTime=a,{id:i.traceId,promise:i.promise}},resolve:function(e,t){if(0!=e.indexOf(P)&&!L(e)){var n=te[e];n&&(Y({namespace:n.namespace,name:n.name,type:B.callback,callbackId:n.traceId,resultCode:t.result},n.startTime),n.resolve(t),n.isMulti||this.removeMQ(e))}},reject:function(e,t){var n=te[e];n&&(n.resolve(t),n.isMulti||this.removeMQ(e),L(e)||Y({namespace:n.namespace,name:n.name,type:B.callback,callbackId:n.traceId,resultCode:t.result,errorMsg:t.message},n.startTime))}},re=["popBack","exitWebView"],ie=["setPhysicalBackButton","setTopLeftBtn","setTopLeftSecondBtn","setTopRightBtn","setTopRightSecondBtn"],ae=["on","off"],oe={Kwai:"kwai",KwaiAd:"kwaiAd",KwaiAdThird:"kwaiAdThird",KwaiMerchant:"kwaiMerchant",KwaiLive:"kwaiLive"},se={kwai:"Kwai",kwaiAd:"KwaiAd",kwaiAdThird:"KwaiAdThird",kwaiMerchant:"KwaiMerchant",kwaiLive:"KwaiLive",Kwai:"Kwai",KwaiAd:"KwaiAd",KwaiAdThird:"KwaiAdThird",KwaiMerchant:"KwaiMerchant",KwaiLive:"KwaiLive"},ce={home:["changeActivityTemplate","isActivityTabActive"]},ue=navigator.userAgent,le=re,de=ie,pe=ae;function fe(e){return"function"==typeof e}function he(){return!!ue.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)}function me(e,t,n){var r="yoda_kuaishou_plugin_callback_"+n+"_"+function(e){void 0===e&&(e=!0);var t=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(t+=performance.now()),(e?"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx":"xxxxxxxx_xxxx_4xxx_yxxx_xxxxxxxxxxxx").replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)}))}(!1);return window[r]=function(n){if("string"==typeof n)try{n=JSON.parse(n)}catch(e){}fe(e)?e.call(window,n):"string"==typeof e&&fe(window[e])&&window[e].call(window,n),t||delete window[r]},r}function ve(e,t){var n=e;return e&&Array.isArray(e.actions)&&(n.actions=e.actions.map((function(e){return e&&e.url&&fe(e.url)&&(e.url=me(e.url,!0,t)),e}))),n}var ge={};function ye(e,t,n,i){var a=r({},n),o=e+"_"+t;if(de.indexOf(t)>-1)a.onClick=me(a.onClick,!0,o);else if(le.indexOf(t)>-1)a=null;else if(pe.indexOf(t)>-1){var s=me(i,!1,o);a.handler&&fe(a.handler)&&(a.handler=function(e,t){var n="",r=null;if(Object.keys(ge).some((function(t){var i=ge[t];if(i===e)return r=i,n=t,!0})),r!==e&&e){var i=me(e,!0,t);ge[i]=e,n=i}return n}(a.handler,o)),a.callback=s}else if("showDialog"===t){var c=a.positiveButton,u=a.negativeButton,l=a.neutralButton;c&&(a.positiveButton=ve(c,o)),u&&(a.negativeButton=ve(u,o)),l&&(a.neutralButton=ve(l,o))}else{s=me(i,!0,o);a.callback=a.callback||s}return a}var _e=null,we=function(){Object.defineProperty&&Object.defineProperty(window,"__yodaBridgeCallback__",{set:function(e){if(_e)throw new Error("当前环境可能存在yoda 多实例的情况，请排查第三方依赖包");_e=e},get:function(){return _e}})},be="ios"===x(window.navigator.userAgent),Se={requestLocationPermission:"requestLocationPermissionWithPermissionCheck",getLocation:"getLocationWithPermissionCheck",syncLocation:"syncLocationWithPermissionCheck"};function ke(e){return a(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,E("kwai",Se[e])];case 1:return[2,t.sent()]}}))}))}function Ee(e){return a(this,void 0,void 0,(function(){var t,n,a,s,c,u,l,d;return o(this,(function(o){switch(o.label){case 0:return t=e.namespace,n=e.handlername,a=e.data,s=e.callback,function(e,t){return"kwai"===e.toLocaleLowerCase()&&!!Se[t]}(t,n)?N?(e.namespace="system",e.handlername="requestLocation",e.callback=function(e){return s(r(r({},e),{version:3}))},[2]):(c=a.biz,u=a.force,l=i(a,["biz","force"]),d=void 0===u?2:u?1:3,e.data=r(r({},l),{biz_type:c,forced_permission_request:d}),[4,ke(n)]):[2];case 1:return o.sent()?(e.handlername=Se[n],e.callback=function(e){return s(r(r({},e),{version:2}))},[2]):(be&&"requestLocationPermission"===n&&(e.handlername="requestLocationAuthorization"),e.callback=function(e){return s(r(r({},e),{version:1}))},[2,e])}}))}))}function xe(e,t){return M()&&b("9.10.11",A)<=0?function(e,t){var n={namespace:e,name:t};return"hybrid"==e&&("getHybridStatus"==t?(n.name="pageContentStatus",n.namespace="webview"):"getAndUpdateHybridDetail"==t?(n.name="pageContentInfo",n.namespace="webview"):"preloadVideoList"==t?(n.name="pvList",n.namespace="media"):"isVideoFullyCached"==t&&(n.name="vReady",n.namespace="media")),n}(e,t):{namespace:e,name:t}}function Oe(e,t){var n="string"==typeof t?JSON.parse(t):t;1===n.result?ne.resolve(e,n):ne.reject(e,n)}we(),window.__yodaBridgeCallback__=Oe;var Pe={},Te={},Ie=!1;function Ce(){if(Ie)return Te;for(var e in Ie=!0,oe)for(var t in window[e]){var n=oe[e];if(n){var i={};"kwai"===n&&"emit"===t&&(i.before=function(e){return e&&"object"==typeof e.data&&null!==e.data&&(e.data=JSON.stringify(e.data)),e}),Pe[n]=Pe[n]||{},Pe[n][t]=i,Pe[e]=Pe[e]||{},Pe[e][t]=i}}return Te=r({webview:{open:{ksName:"loadUrlOnNewPage",before:function(e){return{url:e.url,type:e.type||"back"}}},close:{ksName:he()?"exitCurrentWebview":"exitWebView"},backOrClose:{ksName:"popBack"},openKsWebview:{ksName:"loadUrlOnNewPage"}},tool:{canIUse:{ksName:"isSupport",after:function(e){return{result:1,canUse:!!e}}},setClipBoard:{}},ui:{setSlideBackBehavior:{ksName:"setSlideBack",before:function(e){return{enabled:"none"!==e.behavior}}},showToast:{},showDialog:{before:function(e,t){var n=e.title,r=void 0===n?"":n,i=e.content,a=void 0===i?"":i,o=e.confirmButtonText,s=void 0===o?"确定":o,c=e.cancelButtonText,u=void 0===c?"取消":c,l=e.showCancelButton,d={title:r,content:a,positiveButton:{text:s,colorType:"positive",actions:[{actionType:"JS_CALLBACK",url:function(){t({result:1,target:"confirm"})}}]}};return(void 0===l||l)&&(d.negativeButton={text:u,colorType:"negative",actions:[{actionType:"JS_CALLBACK",url:function(){t({result:1,target:"cancel"})}}]}),d}},showBottomSheet:{}},event:{dispatchEvent:{ksName:"emit",before:function(e){return e&&"object"==typeof e.data&&null!==e.data&&(e.data=JSON.stringify(e.data)),e}}},merchant:{getSidToken:{},reqSessionStickyOnTopWithThread:{},querySessionIsStickyOnTop:{}},mediaInteraction:{saveImage:{},selectImage:{}}},Pe)}var Le=function(e){},Ae=function(e){return e};function Ne(e){var t=window.navigator&&(window.navigator.languages||window.navigator.language)||[],n=t.length&&-1===t.indexOf("zh")&&-1===t.indexOf("zh-CN")?"Error occurred, please upgrade your app":"出错啦, 请升级客户端至最新版本";e.callback&&window[e.callback]&&window[e.callback](JSON.stringify({result:127e3,error_msg:n}))}function Re(e,t,n,r){var i=se[e]||"Kwai",a=t.name,o=t.ksName,s=t.before,c=void 0===s?Ae:s,u=t.after,l=void 0===u?Ae:u,d=o||a;fe(c)&&(n=c(n));var p=Le;if(fe(r)&&(p=function(e){var t=e;fe(l)&&(t=l(e)),r(t)}),!d)throw new Error("invoke: 未指定调用调用 bridge");!function(e,t,n,r){var i=ye(e,t,n,r);if("isSupport"!==t)if(window[e]&&window[e][t])try{if(i){var a=void 0;try{a=JSON.stringify(i)}catch(e){throw e.message+=" in JSON.stringify",e}window[e][t](a)}else window[e][t]()}catch(n){Ne(i),setTimeout((function(){throw n.message+=" (from yoda-kuaishou-plugin window."+e+"."+t+")",n}))}else Ne(i);else{var o=n.name;r(!(!window[e]||!window[e][o]))}}(i,d,n,p)}var De,je={invoke:j?{invoke:function(e){var t=this;return new Promise((function(n){var r=e.namespace,i=e.handlername,a=e.callback,o=e.params||e.data,s=Ce()[r],c=s&&s[i];if(c){var u=o||{};c.name=i,Re.call(t,r,c,u,(function(e){a&&a(e),n(e)}))}else{var l={result:125004};if(n(l),!a||"function"!=typeof a)throw new Error("invoke：yoda."+r+"."+i+"不存在");a(l)}}))}}.invoke:{invoke:function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,a,s,c,u,l,d,p,f,h,m,v,g,y,_,w,b;return o(this,(function(o){switch(o.label){case 0:return t=k(),[4,Ee(e)];case 1:return o.sent(),n=e.namespace,r=e.handlername,i=e.data,a=se[n],s=ce[n]||[],c=e.handlername,u=e.isMulti,l=e.callback,d=ne.create(n,c,u,l),p=d.id,f=d.promise,(a||s.indexOf(r)>-1||"sf2022"==n)&&(h=a||n,m=function(e){Oe(p,e)},e.namespace=h,e.data=ye(h,r,i,m)),"tool"===n&&0!==Object.keys(t._apisMap).length&&["getApiList","canIUse"].indexOf(r)>-1?("getApiList"===r&&setTimeout((function(){window.__yodaBridgeCallback__(p,t._apisMap)})),"canIUse"===r&&(v=t._apisMap.apiList,g=xe(i.namespace,i.name),y=g.namespace,_=g.name,w=v.some((function(e){var t=e.namespace,n=e.name;return t.toLocaleLowerCase()==y.toLocaleLowerCase()&&n===_})),setTimeout((function(){window.__yodaBridgeCallback__(p,JSON.stringify({result:1,canUse:w}))})))):(b=xe(e.namespace,c),window.__yodaBridge__.invoke(b.namespace,b.name,JSON.stringify(e.data||{}),String(p))),[2,f]}}))}))}}.invoke};!function(e){e.x="x",e.y="y",e.z="z"}(De||(De={}));var Me,Ue,Be="native_yoda_shaked",Ke={level:2,times:3,intervalTime:1300,iOSIntervalTime:500,androidIntervalTime:1300,isEmitImmediately:!0},Ve={1:{basic:13,total:450},2:{basic:16,total:700},3:{basic:20,total:1100}},We={1:{basic:9,total:220},2:{basic:12,total:400},3:{basic:14,total:500}},Fe=function(){function e(e){var t=this;this.shakeConfig={},this.shakedArr=[],this.isChecking=!1,this.nowStatus={x:0,y:0,z:0},this.lastStatus={x:0,y:0,z:0},this.checkIsShakeStoped=!1,this.notEmitButShaked=!0,this.isShakeStarted=!1,this.isAndroid=!1,this.isArrivedConfigStandard=!1,this.levelMap=Ve,this.dispatchEvent=null,this.setStillShaking=w((function(){return t.notShaking()}),1e3),this.dispatchEvent=e.dispatchEvent,this.isAndroid=e.isAndroid,this.levelMap=this.isAndroid?Ve:We}return e.prototype.setOptions=function(e){e?(this.shakeConfig=r(r({},Ke),e),this.shakeConfig.times=this.isAndroid?this.shakeConfig.times-1:2*(this.shakeConfig.times-1),this.shakeConfig.intervalTime=this.isAndroid?this.shakeConfig.androidIntervalTime:this.shakeConfig.iOSIntervalTime):this.shakeConfig=r({},Ke)},e.prototype.resetShakeStatus=function(e){this.shakedArr=[],this.isChecking=!1,this.notEmitButShaked=!1,e&&(this.isArrivedConfigStandard=!1,this.isShakeStarted=!1)},e.prototype.checkIsShake=function(e){var t=this;if(this.isChecking=!0,Object.keys(this.nowStatus).forEach((function(n){return t.nowStatus[n]=9.8*e[n]})),this.judgeArrivedTerminal())return this.lastStatus={x:0,y:0,z:0},this.handleShakeHappend(),this.setStillShaking(),void(this.isChecking=!1);this.judgeLikelyShake()?this.handleArrivedStandard():this.isChecking=!1},e.prototype.judgeLikelyShake=function(){var e=this.nowStatus,t=e.x,n=e.y,r=e.z,i=this.levelMap[this.shakeConfig.level],a=i.basic,o=i.total;return t>a||n>a||r>a||t*t+n*n+r*r>o},e.prototype.judgeArrivedTerminal=function(){var e=this,t=0,n=0,r=De.x;return Object.keys(this.nowStatus).forEach((function(i){n=Math.abs(e.lastStatus[i]-e.nowStatus[i]),t<n&&(r=i,t=n)})),this.lastStatus[r]*this.nowStatus[r]<0},e.prototype.handleArrivedStandard=function(){this.lastStatus=r({},this.nowStatus),this.checkIsShakeStoped=!1,this.setStillShaking()},e.prototype.handleShakeHappend=function(){return a(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return this.isShakeStarted?[3,2]:[4,this.dispatchEvent({type:"native_yoda_shake_start",data:{}})];case 1:e.sent(),e.label=2;case 2:return this.isShakeStarted=!0,this.updateShakedArr((new Date).getTime()),[2]}}))}))},e.prototype.notShaking=function(){this.checkIsShakeStoped=!0,this.checkDoDelayEmit()},e.prototype.updateShakedArr=function(e){var t=this.shakeConfig.intervalTime;this.shakedArr.length>0?e-this.shakedArr[this.shakedArr.length-1]<=t?this.shakedArr.push(e):(this.shakedArr=[],this.isChecking=!1):this.shakedArr.push(e),this.shakedArr.length>=this.shakeConfig.times?this.handleArrivedEmitStandard():this.isChecking=!1},e.prototype.handleArrivedEmitStandard=function(){this.isArrivedConfigStandard=!0,this.resetShakeStatus(),this.shakeConfig.isEmitImmediately?this.dispatchEvent({type:Be,data:{}}):this.notEmitButShaked=!0},e.prototype.checkDoDelayEmit=function(){this.notEmitButShaked&&this.checkIsShakeStoped&&!this.shakeConfig.isEmitImmediately&&this.dispatchEvent({type:Be,data:{}}),this.isShakeStarted&&this.dispatchEvent({type:"native_yoda_shake_end",data:{isArrivedConfigStandard:this.isArrivedConfigStandard}}),this.resetShakeStatus(!0)},e}(),qe=null,Je=null;function He(){return a(this,void 0,void 0,(function(){var e,t,n;return o(this,(function(r){switch(r.label){case 0:return[4,(e=this).bridge("system","startAccelerometer",{interval:60})];case 1:return t=r.sent(),Je=qe.checkIsShake.bind(qe),[4,e.bridge("event","addEventListener",{type:"accelerometer-change",listener:Je})];case 2:if(n=r.sent(),1===t.result&&1!==n.result&&ze.bind(e)(),1!==t.result||1!==n.result)throw new Error("摇一摇初始化失败，请稍后重试。AccelerometerRes:"+JSON.stringify(t)+";eventRes:"+JSON.stringify(n));return[2]}}))}))}function ze(){return a(this,void 0,void 0,(function(){var e,t,n;return o(this,(function(r){switch(r.label){case 0:return e=this,[4,E.bind(e)("system","stopAccelerometer")];case 1:if(!r.sent())throw new Error("当前APP暂不支持摇一摇");return qe=null,[4,e.bridge("event","removeEventListener",{type:"accelerometer-change",listener:Je})];case 2:return t=r.sent(),[4,e.bridge("system","stopAccelerometer")];case 3:if(n=r.sent(),1!==t.result||1!==n.result)throw new Error("摇一摇停止监听失败。stopRes:"+JSON.stringify(n)+";eventRes:"+JSON.stringify(t));return[2]}}))}))}var Ye=Be,Ge=((Me={})[Ye]=function(e){return a(this,void 0,void 0,(function(){var t,n=this;return o(this,(function(r){switch(r.label){case 0:return t=this,[4,E.bind(t)("system","startAccelerometer")];case 1:if(!r.sent())throw new Error("当前APP暂不支持摇一摇");if(qe)throw new Error("当前存在尚未结束监听的摇一摇");return qe=new Fe({dispatchEvent:function(e){return a(n,void 0,void 0,(function(){return o(this,(function(n){return[2,t.bridge("event","dispatchEvent",e)]}))}))},isAndroid:"android"===x(navigator.userAgent)}),function(e){if(e){var t=e.level,n=e.times;e.intervalTime;var r,i=e.isEmitImmediately;if(void 0!==t&&!Ve[t])throw new Error("请传入正确的level，可选值为1、2、3");if(void 0!==n){if("number"!=typeof(r=n)||r%1!=0)throw new Error("times应为整数");if(n<1)throw new Error("times应大于1")}if(void 0!==i&&"boolean"!=typeof i)throw new Error("isEmitImmediately应为boolean类型")}}(e),qe.setOptions(e),qe.resetShakeStatus(),[4,He.bind(t)()];case 2:return r.sent(),[2]}}))}))},Me),Qe=((Ue={})[Ye]=ze,Ue),Xe=!1;function $e(e,t){var n,r,i,a=e.type,o=e.listener,s="string"==typeof a?a:a.type,c="string"==typeof a?{}:a.options;if(null===(n=Ge[s])||void 0===n||n.bind(this)(c),!o.__yodaCallbackId__&&(o.__yodaCallbackId__={}),o.__yodaCallbackId__[s])throw new Error("addEventListener "+s+" 的 listener 已经被绑定过了");if(W(s))"function"==typeof t&&t({result:1});else{var u=ne.pushMQ(!0,function(e){return function(t){var n=V[e];Object.keys((null==n?void 0:n.eventRecord)||{}).forEach((function(e){return n.eventRecord[Number(e)](_(t))}))}}(s),!0);r=parseInt(u.traceId),i=je.invoke({namespace:"event",handlername:"addEventListener",data:{type:s,listener:String(u.traceId)},isMulti:!1,callback:t})}return function(e,t,n){var r=V[e]||{callbackId:n,eventRecord:{}},i=y();t.__yodaCallbackId__[e]=String(i),r.eventRecord[i]=t,V[e]=r}(s,o,r),i}function Ze(e,t){var n,r,i=e.type,a=e.listener;if(null===(n=Qe[i])||void 0===n||n.bind(this)(),a.__yodaCallbackId__){var o=function(e){return V[e].callbackId}(i);!function(e,t){var n=V[e],r=t.__yodaCallbackId__[e];delete n.eventRecord[Number(r)],delete t.__yodaCallbackId__[e],W(e)||delete V[e]}(i,a),W(i)||(r=je.invoke({namespace:"event",handlername:"removeEventListener",data:{type:i,listener:o},isMulti:!1,callback:t}),ne.removeMQ(o))}return r}var et={resume:["native_foreground","native_reentry"],pause:["native_background","native_leave"]};function tt(e,t,n){return new Promise((function(r){et[e]?et[e].forEach((function(e){Re("kwai",{name:"on"},{type:e,handler:t},(function(e){n&&n(e),r(e)}))})):Re("kwai",{name:"on"},{type:e,handler:t},(function(e){n&&n(e),r(e)}))}))}function nt(e,t,n){return new Promise((function(r){if(!et[e])return Re("kwai",{name:"off"},{type:e,handler:t},(function(e){n&&n(e),r(e)}));et[e].forEach((function(e){Re("kwai",{name:"off"},{type:e,handler:t},(function(e){n&&n(e),r(e)}))}))}))}var rt=function(){var e=this;e.event=e.event||{},e.event.addEventListener=tt.bind(e),e.event.removeEventListener=nt.bind(e)},it=[{namespace:"event",name:"addEventListener",headler:$e},{namespace:"event",name:"removeEventListener",headler:Ze}],at=function(){if(!Xe){Xe=!0;var e=this,t=e.event;t&&t.addEventListener&&(t.addEventListener=function(t,n,r){return $e.bind(e)({type:t,listener:n},r)}),t&&t.removeEventListener&&(t.removeEventListener=function(t,n,r){return Ze.bind(e)({type:t,listener:n},r)})}};D||(it=[{namespace:"event",name:"addEventListener",headler:function(e,t){return tt(e.type,e.listener,t)}},{namespace:"event",name:"removeEventListener",headler:function(e,t){return nt(e.type,e.listener,t)}}],at=rt);var ot=at,st=it;function ct(e){return a(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return function(e,t){},t=Object.keys(e),[4,Promise.all(t.reduce((function(t,n){try{var r=e[n]();return!(i=r)||"object"!=typeof i&&"function"!=typeof i||"function"!=typeof i.then||r.catch((function(e){return null})),s(s([],t),[r])}catch(e){}var i;return t}),[]))];case 1:return[2,n.sent().reduce((function(e,n,i){var a;return n?r(r({},e),((a={})[t[i]]=n,a)):e}),{})]}}))}))}var ut=125007,lt=function(e){return{result:ut,message:e}},dt=6e5,pt=["m4a"],ft={startConfigEmpty:"start 方法需要传入 config 参数",startDurationEmpty:"duration 应该为大于等于 0 的整数",startDurationLimit:"duration 不能超过最大值 600000（10分钟）",startFormat:"format 只支持: "+pt.join(";")};function ht(){return a(this,void 0,void 0,(function(){var e,t,n;return o(this,(function(r){switch(r.label){case 0:return[4,E("event","addEventListener")];case 1:return e=r.sent(),[4,E("system","startAudioRecorder")];case 2:return t=r.sent(),[4,E("system","stopAudioRecorder")];case 3:return n=r.sent(),[2,e&&t&&n]}}))}))}function mt(){var e=k(),t=!1,n={start:[],stop:[],error:[]},r=new Map,i=function(r){return function(i){return t||(t=!0,e.bridge("event","addEventListener",{type:"native_audio_recorder_start",listener:a("start")}),e.bridge("event","addEventListener",{type:"native_audio_recorder_stop",listener:a("stop")}),e.bridge("event","addEventListener",{type:"native_audio_recorder_error",listener:a("error")})),n[r].push(i),function(){return n[r]=n[r].filter((function(e){return e!==i}))}}},a=function(e){return function(t){r.has(t.taskId)&&("stop"!==e&&"error"!==e||r.delete(t.taskId),n[e].forEach((function(e){return t?e(t):e()})))}};return{onStart:i("start"),onStop:i("stop"),onError:i("error"),addListenId:function(e){return r.set(e,!0)},rmListenId:function(e){return r.delete(e)}}}var vt="readFile 方法需要传入 config 参数",gt="filePath 参数不能为空",yt="encoding 参数不能为空";function _t(){return a(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,E("system","readFile")];case 1:return[2,e.sent()]}}))}))}function wt(e){var t=e.longitude,n=void 0===t?0:t,r=e.latitude,i=void 0===r?0:r,a=e.success,o=void 0!==a&&a,s=e.msg;return{longitude:n,latitude:i,success:o,msg:void 0===s?"":s}}function bt(e,t,n){var r=k();return new Promise((function(i){r.bridge(e,t,n,i)}))}function St(e){return a(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(i){switch(i.label){case 0:return[4,bt("kwai","syncLocation",e)];case 1:return t=i.sent(),n=t.result,r=t.data,1===n?[2,wt({longitude:r.longitude,latitude:r.latitude,success:!0,msg:"成功"})]:[2,wt({success:!1,msg:"[kwai.syncLocation] 获取失败, code: "+n})]}}))}))}function kt(e){var t=e.useLastLocationWhileLimited,n=i(e,["useLastLocationWhileLimited"]);return a(this,void 0,void 0,(function(){var e,i,a,s,c,u,l,d,p,f,h,m,v,g;return o(this,(function(o){switch(o.label){case 0:return D?N?(e=!n.updateLocationScene,i=wt({longitude:0,latitude:0,success:!0,msg:"成功"}),[4,bt("system","requestLocation",r(r({},n),{useInterval:e}))]):[3,4]:[2,wt({msg:"非 Yoda 环境"})];case 1:return a=o.sent(),s=a.longitude,c=a.latitude,u=a.result,l=a.message,i.longitude=s||0,i.latitude=c||0,1!==u&&(i.msg="[system.requestLocation] 获取失败，code: "+u+", msg: "+l,i.success=!1),t&&10014===u?[4,bt("system","getLocationCityInfo",{biz:n.biz})]:[3,3];case 2:d=o.sent(),p=d.longitude,f=d.latitude,h=d.result,m=d.message,i.longitude=p||0,i.latitude=f||0,1!==h||!p&&!f?(i.success=!1,i.msg="[system.requestLocation] 受频控限制，尝试从 [system.getLocationCityInfo] 获取缓存位置失败, msg: "+m):(i.success=!0,i.msg="[system.requestLocation] 受频控限制，从 [system.getLocationCityInfo] 获取到了缓存位置信息"),o.label=3;case 3:return[2,i];case 4:return[4,St(r(r({},n),{force:!1}))];case 5:return(v=o.sent()).success?[2,v]:[4,bt("kwai","requestLocationPermission",n)];case 6:return 1!==(g=o.sent().result)?[2,wt({success:!1,msg:"[kwai.requestLocationPermission] 获取失败，code: "+g})]:[2,St(n)]}}))}))}var Et={recorderManager:function(){return a(void 0,void 0,void 0,(function(){var e,t,n,i,s,c,u;return o(this,(function(l){switch(l.label){case 0:return[4,ht()];case 1:return l.sent()?(e=k(),t=mt(),n=t.onStart,i=t.onStop,s=t.onError,c=t.addListenId,u=t.rmListenId,[2,{start:function(t){return a(void 0,void 0,void 0,(function(){var n,i,a;return o(this,(function(o){switch(o.label){case 0:return(n=function(e){return e?!Number.isInteger(e.duration)||e.duration<=0?lt(ft.startDurationEmpty):e.duration>dt?lt(ft.startDurationLimit):e.format&&pt.includes(e.format)?null:lt(ft.startFormat):lt(ft.startConfigEmpty)}(t))?[2,n]:(i=""+Date.now(),c(i),[4,e.bridge("system","startAudioRecorder",r(r({},t),{taskId:i}))]);case 1:return(a=o.sent())&&1===a.result||u(i),[2,a]}}))}))},stop:function(){return e.bridge("system","stopAudioRecorder",{})},onStart:n,onStop:i,onError:s}]):[2,null]}}))}))},fileManager:function(){return a(void 0,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return e=k(),[4,_t()];case 1:return t.sent()?[2,{readFile:function(t){var n=function(e){return e?e.filePath?e.encoding?null:lt(yt):lt(gt):lt(vt)}(t);return n||e.bridge("system","readFile",t)}}]:[2,null]}}))}))},location:function(){return{get:kt}}};function xt(){return a(this,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:return e=k(),[4,ct(Et)];case 1:return t=n.sent(),e.feApi=t,[2]}}))}))}var Ot=!1;var Pt=function(){var e=this,t=this,n=function(){if(!Ot){Ot=!0;var n=Date.now();t.register({namespace:"tool",name:"getApiList"}),t.tool.getApiList({},(function(r){var i=r.result,s=r.apiList;return a(e,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:for(1!==i&&(s=c),1===i&&(t._apisMap={result:i,apiList:s}),e=s.length;e--;)t.register(_(s[e]));return ot.bind(t)(),[4,xt()];case 1:return r.sent(),It(null),t.isReady=!0,ee.call(t,"2fa790a375",{name:"yoda_auto_register",category:"yoda_js_sdk",result_type:i,extra_info:JSON.stringify({res:t._apisMap,apiLength:s.length})},n),[2]}}))}))}))}};window.__yodaBridge__?n():window.__yodaBridgeReady__=n};j&&(Pt=function(){return a(this,void 0,void 0,(function(){var e,t,n,r;return o(this,(function(i){switch(i.label){case 0:for(t in rt.bind(this)(),e=Ce())for(r in n=e[t])n[r]&&this.register({namespace:t,name:r,multiCallback:!0});return[4,xt()];case 1:return i.sent(),It(null),[2]}}))}))});var Tt,It,Ct,Lt=Pt;function At(){var e=k();return Ct||(Ct=e.bridge("tool","getCommonConfig",{})),Ct}function Nt(e,t){var n,r,i;return a(this,void 0,void 0,(function(){var a,s,c,u,l,d,p,f,h,m;return o(this,(function(o){switch(o.label){case 0:if(a=k(),s=e.header,c=e.method,u=e.data,l=e.url,d=e.timeout,(p=e.responseType)||(p="json"),c||(c="get"),-1==["get","post"].indexOf(c.toLocaleLowerCase()))throw Error("tool.request only supports get/post ");return l=function(e,t){var n=e;/^http/.test(e)||(n=[window.location.origin,e].join(""));var r=[];if(!t)return n;for(var i in t)r.push(i+"="+t[i]);return n+(n.indexOf("?")>-1?"&":"?")+r.join("&")}(l,e.params),d=d,a.isInYoda&&(null===(n=window.__yodaBridge__)||void 0===n?void 0:n.invoke)&&(he()||b("9.9.40",A)<0)?[4,At()]:[3,3];case 1:return 1==(f=o.sent()).result&&(null===(i=null===(r=f.configData)||void 0===r?void 0:r.bridge)||void 0===i?void 0:i.enableRequestProxy)?(h=Dt(s,!0),[4,je.invoke({namespace:"tool",handlername:"request",data:{method:c,data:JSON.stringify(u),url:l,header:h,timeout:d,responseType:p},isMulti:!1,callback:t})]):[3,3];case 2:if(m=o.sent(),"json"==p&&"string"==typeof m.data)try{m.data=JSON.parse(m.data)}catch(e){m.data={}}return"125010"==m.result&&(!m.profile&&(m.profile={}),m.profile.isTimeout=!0),"1"!=m.result&&(m=Rt({header:s,data:u,method:c,url:l,timeout:d,responseType:p,callback:t})),[2,m];case 3:return[2,Rt({header:s,data:u,method:c,url:l,timeout:d,responseType:p,callback:t})]}}))}))}function Rt(e){var t=e.header,n=e.data,r=e.method,i=e.url,s=e.timeout,c=e.responseType,u=e.callback;return a(this,void 0,void 0,(function(){var e,a;return o(this,(function(o){var l;return e=Dt(t),l={method:r,data:JSON.stringify(n),url:i,header:e,timeout:s,responseType:c},a=new Promise((function(e,t){var n,r=new XMLHttpRequest,i=l.method,a=l.header,o=l.timeout,s=void 0===o?O:o,c=l.data,u=l.responseType,d=l.url;for(var p in r.responseType=u,r.timeout=s,r.open(i.toUpperCase(),d,!0),r.onreadystatechange=function(){if(4===r.readyState&&200==r.status){n&&clearTimeout(n);var t={result:1,data:r.response,statusCode:r.status};e(t),r=null}},a)r.setRequestHeader(p,a[p]);r.send(c),s>0&&(n=setTimeout((function(){r.abort(),n=null,e({result:125010,profile:{isTimeout:!0}})}),s))})),u&&(a=a.then((function(e){u(e)}))),[2,a]}))}))}function Dt(e,t){void 0===t&&(t=!1),!e&&(e={});var n="content-type",r=Object.keys(e||{}),i=["application/json","application/x-www-form-urlencoded"];return r.forEach((function(t){var r=e[t];if(t.toLocaleLowerCase()==n){if(-1==i.indexOf(r.toLocaleLowerCase()))throw Error("header:"+t+" 仅支持 application/json、application/x-www-form-urlencoded");delete e[t],e[t.toLocaleLowerCase()]=r.toLocaleLowerCase()}else-1!==["accept","accept-encoding","accept-language"].indexOf(t.toLowerCase())&&(delete e[t],e[t.toLocaleLowerCase()]=r.toLocaleLowerCase())})),!e[n]&&(e[n]=i[0]),t&&(!e.accept&&(e.accept="*/*"),!e["accept-encoding"]&&(e["accept-encoding"]="gzip, deflate"),!e["accept-language"]&&(e["accept-language"]=navigator.language?navigator.language:navigator.languages.join(",")),!e["user-agent"]&&(e["user-agent"]=(null===navigator||void 0===navigator?void 0:navigator.userAgent)||"")),e}Tt=new Promise((function(e){It=e}));var jt=[{namespace:"tool",name:"request",headler:function(e,t){return a(this,void 0,void 0,(function(){return o(this,(function(n){return[2,Nt(e,t)]}))}))}}];function Mt(e,t,n,r){var i=st.filter((function(n){return t==n.name&&e==n.namespace}));return i.length,i.length>0?i[0].headler.bind(this)(n,r):void 0}function Ut(e,t,n,r){var i=k();if(i.mockApiList&&!i.isInYoda){var a=i.mockApiList.filter((function(n){return t==n.name&&e==n.namespace}));if(1==a.length){var o=new Promise((function(e){e(a[0].headler())}));return r&&o.then(r),o}a.length}var s=jt.filter((function(n){return t==n.name&&e==n.namespace}));return s.length,s.length>0?s[0].headler.bind(this)(n,r):void 0}function Bt(e){var t=this,n=d[e.namespace+"."+e.name];return n&&(e=r(r({},e),n)),function(n,r,i,a){var o;return"function"==typeof r&&(i=r),e.before&&(n=e.before(n)),e.after&&i&&(i=function(t){i(e.after(t))}),a&&(o=Mt.bind(t)(e.namespace,e.name,n,i)),o||(o=Ut.bind(t)(e.namespace,e.name,n,i)),o||je.invoke.bind(t)({namespace:e.namespace,handlername:e.name,data:n,isMulti:(null==e?void 0:e.multiCallback)||(null==r?void 0:r.multiCallback),callback:i})}}function Kt(e){var t=e.namespace,n=e.name,r=e.params,i=e.option,a=e.callback;return Bt.bind(this)({namespace:t,name:n})(r,i,a,!0)}function Vt(e){var t=this;(t[e.namespace]=t[e.namespace]||{})[e.name]=Bt.bind(this)(e),(t.apiList||[]).push(e)}function Wt(e){if(this.isInYoda){var t=e||{},n=t.namespace,r=t.name,i=oe[n];i&&("kwai"===i&&"emit"===r&&(e.before=function(e){return e&&"object"==typeof e.data&&null!==e.data&&(e.data=JSON.stringify(e.data)),e}),e.namespace=i)}return e}function Ft(e){var t=this;if(t.isInYoda){var n=e||{},r=n.namespace,i=n.name,a=se[r];a&&(t[a]=t[a]||{},t[a][i]=t[r][i])}}function qt(e){return new Promise((function(t){var n=k();n.ready((function(){if(n[e.namespace]&&n[e.namespace][e.name])n[e.namespace][e.name](e.params,e.option,e.callback).then((function(e){t(e)}));else{var r={result:125004};e.callback&&e.callback(r),t(r)}}))}))}var Jt={isInYoda:D,isReady:!1,ready:function(e){return e&&Tt.then(e),!this.isReady&&Lt.bind(this)(),Tt},invoke:je.invoke,plugin:function(){Lt.bind(this)()},register:function(e){D&&(e=Wt.bind(this)(e)),Vt.bind(this)(e),D&&Ft.bind(this)(e)},_apisMap:{},startMock:function(e){Jt.mockApiList=e},bridge:function(e,t,n,r){var i={namespace:e,name:t,params:n,callback:r?function(e){r(e)}:null};return!R()||M()||l(e,t)?Kt(i):qt(i)},multiBridge:function(e,t,n,r){var i={namespace:e,name:t,params:n,option:{multiCallback:!0},callback:r?function(e){r(e)}:null};return!R()||M()||l(e,t)?Kt(i):qt(i)}};!function(e){S=e}(Jt)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorkspace=t.getWorkspaceName=void 0;var r=n(0);t.getWorkspaceName=function(){return"object"==typeof window&&window[r.KWAI_ANALYTICS_OBJECT]||r.KWAI_Q};t.getWorkspace=function(){return"object"==typeof window&&window[(0,t.getWorkspaceName)()]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xhrService=void 0;var r=n(0),i=function(){var e=this;this.post=function(t,n){return new Promise((function(r,i){var a=new XMLHttpRequest;a.open("POST",t,!1),a.setRequestHeader("content-type","application/json");var o=e.format(n);a.onload=function(){a.status>=200&&a.status<300?r(a.response):i(a.statusText)},a.onerror=function(){return i(a.statusText)},a.withCredentials=!0,a.send(JSON.stringify(o))}))},this.format=function(e){var t=e.eventName,n=void 0===t?"":t,i=e.context,a=void 0===i?{}:i,o=e.params,s=void 0===o?{}:o,c=a.ad,u=void 0===c?{}:c,l=a.pixel,d=void 0===l?{}:l,p=a.libVersion,f=void 0===p?"":p,h=a.trackFlag,m=void 0!==h&&h;return{clickid:u.callback||"",event_name:r.EVENT_NAME[n]||r.UNKNOWN_EVENT,is_attributed:0,mmpcode:"PL",pixelId:d.code||"",pixelSdkVersion:f,testFlag:!r.PRODUCTION,trackFlag:m,pixelExtData:JSON.stringify(s)}},this.get=function(e){return new Promise((function(t,n){var r=new XMLHttpRequest;r.responseType="json",r.open("GET",e),r.onload=function(){if(r.status>=200&&r.status<300){var e=r.response;e.data&&e.data.length>0?t(e):n("pixel not exist")}else n(r.statusText)},r.onerror=function(){return n(r.statusText)},r.withCredentials=!0,r.send()}))}};t.xhrService=new i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(8),a=n(5);!function(){var e=(0,a.getWorkspace)(),t=e.initialize;if(void 0!==t&&t)e.handleCache();else{var n=new i.KwaiManager(r.SDK_VERSION),o=(0,a.getWorkspaceName)();["instance","instances","usePlugin","loadPixel","enableCookie","disableCookie"].forEach((function(t){Object.defineProperty(e,t,{get:function(){return function(){try{return n[t].apply(n,Array.prototype.slice.call(arguments))}catch(e){return{}}}},set:function(){}})})),["page","track"].forEach((function(t){Object.defineProperty(e,t,{get:function(){return function(){try{var e=Array.prototype.slice.call(arguments);return n[t].apply(n,e)}catch(e){return{}}}},set:function(){}})}));var s=Object.getPrototypeOf(n);window[o]=Object.assign(e,n,s),n.init()}}()},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.KwaiManager=void 0;var a=n(9),o=n(30),s=n(5),c=function(e){function t(t){var n=e.call(this,new a.KwaiContext(t))||this;return n.init=function(){n.context.init(),n.setPageInfo(window.location.href,document.referrer),n.handleCache()},n.handleCache=function(){var e=(0,s.getWorkspace)(),t=e._i;if(Object.entries(t).forEach((function(e){var t=e[0],r=e[1],i=!1;if(!0!==r._init&&(n.loadPixel(t),r._init=!0,i=r.length>0),i)for(;r.length;){var a=r.shift();if(a){var o=a[0],s=a.slice(1),c=n.instance(t);if(c)switch(o){case"page":n.page(s[0]);break;case"track":c.track(s[0],s[1])}}}})),e.length>0)for(;e.length;){var r=e.shift();if(r){var i=r[0],a=r.slice(1);switch(i){case"page":n.page(a[0]);break;case"track":n.track(a[0],a[1])}}}},n.createPixel=function(e){return new o.KwaiPixel(e,n.context)},n.initDynamicPlugin=function(){var e=(0,s.getWorkspace)().dynamicPlugins;(void 0===e?[]:e).forEach((function(e){try{n.useDynamicPlugin(e.handler)}catch(e){}}))},n}return i(t,e),t}(n(32).Manager);t.KwaiManager=c},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.KwaiContext=void 0;var a=n(10),o=function(e){function t(t){var n=e.call(this,t)||this;return n.init=function(){n.listenSPAHistoryChange(),n.onPageLoaded(),n.onPageLeave()},n.onPageLoaded=function(){window.addEventListener("load",(function(){n.plugins.forEach((function(e){return e.pageDidLoad()}))}),{once:!0})},n.onPageLeave=function(){window.addEventListener("beforeunload",(function(){var e=Date.now();n.plugins.forEach((function(t){return t.pageWillLeave(e)}))}),{once:!0})},n.trackSync=function(t,r,i,a){n.kwai_test_id?n.data.trackFlag=!0:n.data.trackFlag=!1,e.prototype.trackSync.call(n,t,r,i,a)},n.listenSPAHistoryChange=function(){var e=function(e,t){var n=history[e];return function(){n.apply(history,arguments),t()}},t=n.data.pageInfo.url,r=function(){var e=location.href;e!==t&&n.setPageInfo(e)};window.addEventListener("popstate",r),history.pushState=e("pushState",r),history.replaceState=e("replaceState",r)},n.kwai_test_id=(0,a.getTestId)(),n}return i(t,e),t}(n(19).Context);t.KwaiContext=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTestId=void 0;var r=n(1),i=n(0);t.getTestId=function(){var e=(0,r.getSearchParams)(window.location.href,i.KWAI_TEST_ID)||(0,r.getSearchParams)(document.referrer,i.KWAI_TEST_ID),t=(0,r.getValFromCookieByName)(i.KWAI_TEST_ID);if(e&&e!==t){var n=(0,r.getDomain)();document.cookie=i.KWAI_TEST_ID+"="+e+"; expires=session; path=/;domain="+n}return e||t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSearchParams=void 0;t.getSearchParams=function(e,t){try{return function(e,t){t=t||window.location.search.substr(1)||window.location.hash.split("?")[1];var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),r=t.match(n);return null!=r?unescape(r[2]):null}(t,e)||""}catch(e){return""}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDomain=void 0;var r=n(13);t.getDomain=function(e){void 0===e&&(e=window.location.hostname);var t=e.split("."),n=t[t.length-1],i=Number.parseInt(n);if(!isNaN(i))return e;for(var a=[];t.length;){var o=t.pop();if(!o)break;if(a.unshift(o),-1===r.DOMAINS.indexOf(o))break}return"."+a.join(".")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DOMAINS=void 0,t.DOMAINS=["ac","ad","ae","af","ag","ai","al","am","ao","aq","ar","as","at","au","aw","ax","az","ba","bb","bd","be","bf","bg","bh","bi","bj","bm","bn","bo","br","bs","bt","bw","by","bz","ca","cc","cd","cf","cg","ch","ci","ck","cl","cm","cn","co","cr","cu","cv","cw","cx","cy","cz","de","dj","dk","dm","do","dz","ec","ee","eg","er","es","et","eu","fi","fj","fk","fm","fo","fr","ga","gd","ge","gf","gg","gh","gi","gl","gm","gn","gp","gq","gr","gs","gt","gu","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","il","im","in","io","iq","ir","is","it","je","jm","jo","jp","ke","kg","kh","ki","km","kn","kp","kr","kw","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mg","mh","mk","ml","mm","mn","mo","mp","mq","mr","ms","mt","mu","mv","mw","mx","my","mz","na","nc","ne","nf","ng","ni","nl","no","np","nr","nu","nz","om","pa","pe","pf","pg","ph","pk","pl","pm","pn","pr","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sk","sl","sm","sn","so","sr","ss","st","su","sv","sx","sy","sz","tc","td","tf","tg","th","tj","tk","tl","tm","tn","to","tr","tt","tv","tw","tz","ua","ug","uk","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","ye","yt","za","zm","zw","bar","bible","biz","church","club","college","com","design","dev","download","eco","eus","google","green","hiv","icu","info","kaufen","kiwi","lat","lgbt","moe","name","net","ninja","ngo","one","ong","ooo","org","top","pro","wiki","wtf","xyz","app","aero","asia","cat","coop","edu","gov","int","jobs","mil","mobi","museum","post","tel","travel","xxx","africa","alsace","amsterdam","bcn","berlin","brussels","bzh","cymru","eu","eus","frl","gal","gent","irish","ist ","istanbul","kiwi","krd","lat","london","melbourne","miami","nyc","paris","quebec","rio","saarland","scot","sydney","taipei","tokyo","vegas","vlaanderen","wales","wien","arpa","nato","example","invalid","localhost","test","onion","bit","bitnet","csnet","exit","local","onion","root","uucp","chn","africa","bcn","wales","bzh","cym","cymru","eng","lli","sic","wales","geo","mail","web","free","kid","kids","music","bl ","bq ","eh ","mf","bv ","gb ","sj","an ","bu ","cs ","dd ","tp ","um ","yu ","zr"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getValFromCookieByName=void 0;t.getValFromCookieByName=function(e){if(document.cookie.length>0){var t=document.cookie.indexOf(e+"=");if(-1!==t){var n=t+e.length+1,r=document.cookie.indexOf(";",n),i="";return i=-1===r?document.cookie.substring(n):document.cookie.substring(n,r),unescape(i)}}return""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRandom=void 0;t.getRandom=function(e){return e+"-"+Date.now()+"-"+(Math.floor(8999999999999*Math.random())+1e12)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readVal=t.writeVal=void 0;t.writeVal=function(e,t){try{var n=JSON.stringify(t);window.sessionStorage.setItem(e,n)}catch(e){throw e}};t.readVal=function(e){try{var t=window.sessionStorage.getItem(e);return t?JSON.parse(t):null}catch(e){throw e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.urlParse=t.getObjIn=t.getUrlIn=void 0;t.getUrlIn=function(e,n){if(e.indexOf(n)>-1)return!0;if((e.split("?")[0].split("https://")[1]||e.split("?")[0].split("http://")[1]||e.split("?")[0])===(n.split("?")[0].split("https://")[1]||n.split("?")[0].split("http://")[1]||n.split("?")[0])){var r=(0,t.urlParse)(e),i=(0,t.urlParse)(n);return(0,t.getObjIn)(r,i)}return!1};t.getObjIn=function(e,t){var n=!0;for(var r in t)if(t[r]!==e[r]){n=!1;break}return n};t.urlParse=function(e){var t={},n=e.match(/[?&][^?&]+=[^?&]+/g);return n&&n.forEach((function(e){var n=e.substring(1).split("="),r=decodeURIComponent(n[0]),i=decodeURIComponent(n[1]);t[r]=i})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toHump=void 0;t.toHump=function(e){return e.replace(/\_(\w)/g,(function(e,t){return t.toUpperCase()}))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;var o=n(0),s=n(20),c=n(29),u=n(1),l=n(3),d=n(2),p=n(0),f=a(n(4)),h=function(){function e(e){var t=this;this.plugins=[],this.usePlugin=function(e){t.plugins.push(e)},this.getInitContextData=function(e){return{libVersion:e,pixelMap:{},pageInfo:{url:""},pageSign:t.initPageSign(),adInfo:t.initAdInfo().then((function(e){return t.data.adInfo=e,e}))}},this.initAdInfo=function(){return r(t,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return[4,this.browserAdService.getAdInfo()];case 1:return[2,{callback:(e=t.sent()).callback,pixelId:e.pixelId}]}}))}))},this.track=function(e,n,r,i,a){var o,s,c,u,p;if(t.data.adInfo.pixelId==e)-1==t.data.pageInfo.url.indexOf("type=preload")&&t.trackSync(e,n,r,i);else{var f=JSON.stringify({pixelId:e,urlPixelId:t.data.adInfo.pixelId,clickId:t.data.adInfo.callback,currentHref:window.location.href,eventName:n,params:r,ext:"页面嵌入的pixel与url里的pixel信息不一致，url/bridge里面pixelid是:"+t.data.adInfo.pixelId+"，页面pixelid是："+e+"，上报被拦截，未触发上报接口"});(null===(s=null===(o=t.data)||void 0===o?void 0:o.adInfo)||void 0===s?void 0:s.pixelId)&&18===(null===(c=t.data.adInfo.pixelId)||void 0===c?void 0:c.toString().length)&&/^[0-9]*$/.test(null===(p=null===(u=t.data)||void 0===u?void 0:u.adInfo)||void 0===p?void 0:p.pixelId)?(0,l.logErr)({name:d.LoggerTypesName.errMatchPixelId,extra_info:f}):(0,l.logErr)({name:d.LoggerTypesName.errPixelId,extra_info:f}),t.data.adInfo.callback||(0,l.logErr)({name:d.LoggerTypesName.errClickId,extra_info:f})}},this.addPixel=function(e){var n=e.pixelId;t.data.pixelMap[n]=e,t.plugins.forEach((function(t){return t.pixelDidMount(e)}))},this.getPixel=function(e){return t.data.pixelMap[e]||null},this.getAllPixels=function(){return t.pixels},this.setPageInfo=function(e,n){var r=t.data,i=r.pageInfo,a=r.pageSign;i.url!==e&&(t.plugins.forEach((function(t){return t.pageUrlWillChange(i.url,e)})),void 0!==i.url&&(i.referrer=i.url),n&&(i.referrer=n),a.pageId=(0,u.getRandom)("pageId"),i.url=e,t.plugins.forEach((function(t){return t.pageUrlDidChange(e)})))},this.getSessionIdFromCache=function(){try{return(0,u.readVal)(o.KWAI_SESSION_ID)}catch(e){return null}},this.setSessionIdToCache=function(e){try{(0,u.writeVal)(o.KWAI_SESSION_ID,e)}catch(e){}},this.initPageSign=function(){var e=t.getSessionIdFromCache();return null===e&&(e=(0,u.getRandom)(o.SESSION_ID),t.setSessionIdToCache(e)),{sessionId:e,pageId:(0,u.getRandom)(o.PAGE_ID)}},this.assemblyData=function(e,n,r){var i=t.data,a=i.pageInfo,o=i.pageSign,s=i.libVersion,c=i.adInfo,l=i.trackFlag,d=void 0!==l&&l;return{eventName:n,eventId:(0,u.getRandom)("eventId")+"-"+e,timestamp:(new Date).toJSON(),context:{ad:{callback:c.callback,pixelId:c.pixelId},pixel:{code:e},page:a,libVersion:s,trackFlag:d,sessionId:o.sessionId+"-"+e,pageViewId:o.pageId+"-"+e},params:r}},this.reportService=new c.ReportService,this.browserAdService=new s.BrowserAdService,this.data=this.getInitContextData(e)}return Object.defineProperty(e.prototype,"pixels",{get:function(){var e=this.data.pixelMap;return Object.keys(e).map((function(t){return e[t]}))},enumerable:!1,configurable:!0}),e.prototype.trackSync=function(e,t,n,r){var i=this.getPixel(e);if(null!==i){var a=this.assemblyData(e,t,n),s=o.API[r],c={pixelId:i.pixelId,accessMode:i.accessMode,currentHref:window.location.href};a.params||(a.params={});var d=(0,l.getWdata)(window,document.cookie);a.params.kwaiInfo={currentHref:window.location.href,host:window.location.host,navigator:navigator.userAgent,yodaIsReady:f.default.isReady,tirdParty:d||"none",kwaiAdInfoSource:(0,u.readVal)(p.KWAI_CALLBACK_SOURCE),referrer:document.referrer},s&&this.reportService.report(s,a,c)}},e}();t.Context=h},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserAdService=void 0;var a=n(0),o=n(1),s=n(21),c=function(){var e=this;this.params=s.paramsService,this.getAdInfo=function(){return r(e,void 0,void 0,(function(){var e,t;return i(this,(function(n){switch(n.label){case 0:return(e=(0,o.readVal)(a.KWAI_CALLBACK_SESSION_KEY))?((0,o.writeVal)(a.KWAI_CALLBACK_SOURCE,"context"),[2,e]):[4,this.params.getAdInfo()];case 1:return((t=n.sent()).callback||t.pixelId)&&(0,o.writeVal)(a.KWAI_CALLBACK_SESSION_KEY,t),[2,t]}}))}))}};t.BrowserAdService=c},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.paramsService=void 0;var a=n(0),o=n(1),s=n(22),c=n(3),u=n(2),l=n(1),d=function(){var e=this;this.getAdInfo=function(){return r(e,void 0,void 0,(function(){var e,t;return i(this,(function(n){switch(n.label){case 0:return[4,this.getParamsValue(a.KWAI_CALLBACK)];case 1:return e=n.sent(),[4,this.getParamsValue(a.KWAI_PIXEL_ID)];case 2:return t=n.sent(),[2,{callback:e,pixelId:t}]}}))}))},this.getBrigeData=function(t){return r(e,void 0,void 0,(function(){var e,n,r,a,o;return i(this,(function(i){switch(i.label){case 0:return[4,(0,s.ks_pixel_getPixelBaseInfo)()];case 1:for(e=i.sent(),n=JSON.stringify({bridgeRes:e,currentHref:window.location.href}),1==e.result?e.pixelId&&""!=e.pixelId&&e.clickId&&""!=e.clickId?(0,c.logErr)({name:u.LoggerTypesName.successBridge,extra_info:n}):(0,c.logErr)({name:u.LoggerTypesName.errBridgeForUnPixel,extra_info:n}):(0,c.logErr)({name:u.LoggerTypesName.errBridge,extra_info:n}),r=e[(0,l.toHump)(t[0])]||e[t[0]],a=1;a<t.length;a++){if(!r)return[2,void 0];o=JSON.parse(r),r=o[t[a]]}return[2,r||void 0]}}))}))},this.getParamsValue=function(t){return r(e,void 0,void 0,(function(){var e,n,r,s;return i(this,(function(i){switch(i.label){case 0:return e=t.split("."),n=this.url.searchParams,-1!==this.url.href.indexOf(e[0])?[3,2]:[4,this.getBrigeData(e)];case 1:return r=i.sent(),(0,o.writeVal)(a.KWAI_CALLBACK_SOURCE,"bridge"),[2,r];case 2:return s=n.get(e[0])||this.url.href.split(e[0]+"=")[1].split("&")[0],"click_id"==e[0]&&(s=unescape(s)),(0,o.writeVal)(a.KWAI_CALLBACK_SOURCE,"url"),[2,s||void 0]}}))}))},this.url=new URL(window.location.href)};t.paramsService=new d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ks_pixel_getPixelBaseInfo=void 0;var r=n(23);r.bridge.config({debug:!1,handler:["callPixelBridge"]});t.ks_pixel_getPixelBaseInfo=function(){return r.bridge.kwai_ad_getPixelBaseInfo().then((function(e){return e}),(function(e){return e}))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.yoda=t.bridge=void 0;var o=n(24),s=a(n(4));t.yoda=s.default;var c=a(n(25));s.default.plugin(c.default),s.default.ready((function(){}));var u,l={code:100,message:"kwai-i18n-ad-bridge: Not in KwaiAd container"},d={code:101,message:"kwai-i18n-ad-bridge: The method is not supported "},p=function(e,t){s.default.ready((function(){!function(e,t){var n=s.default;s.default.isInYoda?n[e]&&"function"==typeof n[e][t.action]?n[e][t.action](t).then((function(e){window[t.callback](e)}),(function(e){window[t.callback](e)})):t&&t.callback&&"function"==typeof window[t.callback]&&window[t.callback]({result:d.code,error_msg:d.message}):t&&t.callback&&"function"==typeof window[t.callback]&&window[t.callback]({result:l.code,error_msg:l.message})}(e,t)}))},f=(u=1,function(e,t,n){void 0===n&&(n=!0);var r="jsbcb_"+t+"_"+u++*Math.ceil(1e4*Math.random());return window[r]=function(t){var i=t||"{}";if(i)try{i=JSON.parse(i)}catch(e){}e&&e.call(window,i),n&&delete window[r]},r}),h=function(){var e={debugMode:!1,handler:[],methodList:[],config:function(e){var t=e.handler,n=e.debug;this.debugMode=n||!1,this.handler=t||["callPixelBridge"],this.methodList=o.MethodList,this.setBridge()},debug:function(e){this.debugMode},withScope:function(e){e(h())},setBridge:function(){var t=this,n=this.methodList.filter((function(e){return-1!==t.handler.indexOf(e.jsFunctionName)}));if(0===n.length)throw new Error("kwai-i18n-ad-bridge: all handlers is not supported");n.forEach((function(t){t.methods.forEach((function(n){var r=n.action,i=n.supportPromise;e[r]=function(n){if(i)return new Promise((function(i,a){e.debug("Invoke "+r+" Success With \n "+JSON.stringify(n)),p(t.jsFunctionName,{action:r,data:JSON.stringify(n||{}),callback:f((function(e){e&&1===e.result?i(e):a(e)}),r,!0)})}));return e.debug("Invoke "+r+" Success With \n "+JSON.stringify(n)),p(t.jsFunctionName,{action:r,data:JSON.stringify(n||{}),callback:f((function(e){e&&1===e.result?n.success&&n.success(e):n.error&&n.error(e)}),r,!1)})}}))}))}};return e},m=new Proxy(h(),{get:function(e,t){var n=t.toString();return null===e[n]||e[n],e[n]}});t.bridge=m,i(n(26),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MethodList=void 0,t.MethodList=[{jsFunctionName:"callPixelBridge",methods:[{action:"kwai_ad_getPixelBaseInfo",withParams:!0,supportPromise:!0}]}]},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var c=["popBack","exitWebView"],u=["setPhysicalBackButton","setTopLeftBtn","setTopLeftSecondBtn","setTopRightBtn","setTopRightSecondBtn"],l=["on","off"],d={Kwai:"kwai",KwaiAd:"kwaiAd",KwaiAdThird:"kwaiAdThird",KwaiMerchant:"kwaiMerchant",KwaiLive:"kwaiLive"},p={kwai:"Kwai",kwaiAd:"KwaiAd",kwaiAdThird:"KwaiAdThird",kwaiMerchant:"KwaiMerchant",kwaiLive:"KwaiLive",Kwai:"Kwai",KwaiAd:"KwaiAd",KwaiAdThird:"KwaiAdThird",KwaiMerchant:"KwaiMerchant",KwaiLive:"KwaiLive"},f={home:["changeActivityTemplate","isActivityTabActive"]},h=navigator.userAgent,m=c,v=u,g=l;function y(e){return"function"==typeof e}function _(){return!window.__yodaBridge__}function w(e,t,n){var r=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(t+=performance.now()),(e?"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx":"xxxxxxxx_xxxx_4xxx_yxxx_xxxxxxxxxxxx").replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)}))}(!1),i="yoda_kuaishou_plugin_callback_".concat(n,"_").concat(r);return window[i]=function(n){if("string"==typeof n)try{n=JSON.parse(n)}catch(e){}y(e)?e.call(window,n):"string"==typeof e&&y(window[e])&&window[e].call(window,n),t||delete window[i]},i}function b(e,t){var n=e;return e&&Array.isArray(e.actions)&&(n.actions=e.actions.map((function(e){return e&&e.url&&y(e.url)&&(e.url=w(e.url,!0,t)),e}))),n}var S={};function k(e,t,n,r){var i=o({},n),a="".concat(e,"_").concat(t);if(v.indexOf(t)>-1)i.onClick=w(i.onClick,!0,a);else if(m.indexOf(t)>-1)i=null;else if(g.indexOf(t)>-1){var s=w(r,!1,a);i.handler&&y(i.handler)&&(i.handler=function(e,t){var n="",r=null;if(Object.keys(S).some((function(t){var i=S[t];if(i===e)return r=i,n=t,!0})),r!==e&&e){var i=w(e,!0,t);S[i]=e,n=i}return n}(i.handler,a)),i.callback=s}else if("showDialog"===t){var c=i,u=c.positiveButton,l=c.negativeButton,d=c.neutralButton;u&&(i.positiveButton=b(u,a)),l&&(i.negativeButton=b(l,a)),d&&(i.neutralButton=b(d,a))}else{var p=w(r,!0,a);i.callback=i.callback||p}return i}var E=!1,x={};function O(){if(E)return x;E=!0;var e={};for(var t in d)for(var n in window[t]){var i=d[t];if(i){var a={};"kwai"===i&&"emit"===n&&(a.before=function(e){return e&&"object"===r(e.data)&&null!==e.data&&(e.data=JSON.stringify(e.data)),e}),e[i]=e[i]||{},e[i][n]=a,e[t]=e[t]||{},e[t][n]=a}}return x=o({webview:{open:{ksName:"loadUrlOnNewPage",before:function(e){return{url:e.url,type:e.type||"back"}}},close:{ksName:h.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?"exitCurrentWebview":"exitWebView"},backOrClose:{ksName:"popBack"},openKsWebview:{ksName:"loadUrlOnNewPage"}},tool:{canIUse:{ksName:"isSupport",after:function(e){return{result:1,canUse:!!e}}},setClipBoard:{}},ui:{setSlideBackBehavior:{ksName:"setSlideBack",before:function(e){return{enabled:"none"!==e.behavior}}},showToast:{},showDialog:{before:function(e,t){var n=e.title,r=void 0===n?"":n,i=e.content,a=void 0===i?"":i,o=e.confirmButtonText,s=void 0===o?"确定":o,c=e.cancelButtonText,u=void 0===c?"取消":c,l=e.showCancelButton,d={title:r,content:a,positiveButton:{text:s,colorType:"positive",actions:[{actionType:"JS_CALLBACK",url:function(){t({result:1,target:"confirm"})}}]}};return(void 0===l||l)&&(d.negativeButton={text:u,colorType:"negative",actions:[{actionType:"JS_CALLBACK",url:function(){t({result:1,target:"cancel"})}}]}),d}},showBottomSheet:{}},event:{dispatchEvent:{ksName:"emit",before:function(e){return e&&"object"===r(e.data)&&null!==e.data&&(e.data=JSON.stringify(e.data)),e}}},merchant:{getSidToken:{},reqSessionStickyOnTopWithThread:{},querySessionIsStickyOnTop:{}},mediaInteraction:{saveImage:{},selectImage:{}}},e)}var P=function(){},T=function(e){return e};function I(e){var t=window.navigator&&(window.navigator.languages||window.navigator.language)||[],n=t.length&&-1===t.indexOf("zh")&&-1===t.indexOf("zh-CN")?"Error occurred, please upgrade your app":"出错啦, 请升级客户端至最新版本";e.callback&&window[e.callback]&&window[e.callback](JSON.stringify({result:127e3,error_msg:n}))}function C(e,t,n,r){var i=p[e]||"Kwai",a=t.name,o=t.ksName,s=t.before,c=void 0===s?T:s,u=t.after,l=void 0===u?T:u,d=o||a;y(c)&&(n=c(n));var f=P;if(y(r)&&(f=function(e){var t=e;y(l)&&(t=l(e)),r(t)}),!d)throw new Error("invoke: 未指定调用调用 bridge");!function(e,t,n,r){var i=k(e,t,n,r);if("isSupport"!==t)if(window[e]&&window[e][t])try{if(i){var a;try{a=JSON.stringify(i)}catch(e){throw e.message+=" in JSON.stringify",e}window[e][t](a)}else window[e][t]()}catch(n){I(i),setTimeout((function(){throw n.message+=" (from yoda-kuaishou-plugin window.".concat(e,".").concat(t,")"),n}))}else I(i);else{var o=n.name;r(!!window[e][o])}}(i,d,n,f)}function L(e,t){var n=this;if(_()){var r=O(),i=e.namespace,a=e.name,o=e.params,c=e.callbackId,u=r[i],l=u&&u[a],d=n._callbacks&&n._callbacks[c]||P;if(!l)throw new Error("invoke：yoda.".concat(i,".").concat(a,"不存在"));var h=o||{};return l.name=a,void C.call(n,i,l,h,d)}var m=e.namespace,v=e.name,g=e.params,y=e.callbackId,w=p[m];if(w||(f[m]||[]).indexOf(v)>-1){var b=w||m,S=n._callbacks[y];e.namespace=b,e.params=k(b,v,g,S);var E=s((navigator.userAgent||"").match(/Kwai\/([\d+.*]+)/)||[],2)[1],x=void 0===E?"":E;if(x&&function(){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("."),n=e.split("."),r=0;r<n.length;r++)if(t[r]!==n[r])return t[r]=isNaN(t[r])?0:t[r],n[r]=isNaN(n[r])?0:n[r],t[r]-n[r];return 0}(x,"7.7.30")<0){var T="__yoda_kuaishou_plugin_tmp_cb__";n._callbacks[T]=n._callbacks[T]||P,e.callbackId=T,window.__yoda_kuaishou_plugin_tmp_cb__=P}}else"tool"===m&&"canIUse"===v&&p[g.namespace]&&(g.namespace=p[g.namespace]);t()}var A={resume:["native_foreground","native_reentry"],pause:["native_background","native_leave"]};function N(e,t,n){A[e]?A[e].forEach((function(e){C("kwai",{name:"on"},{type:e,handler:t},n)})):C("kwai",{name:"on"},{type:e,handler:t},n)}function R(e,t,n){A[e]?A[e].forEach((function(e){C("kwai",{name:"off"},{type:e,handler:t},n)})):C("kwai",{name:"off"},{type:e,handler:t},n)}function D(e){e.event=e.event||{},e.event.addEventListener=N.bind(e),e.event.removeEventListener=R.bind(e)}var j=_()?{beforeInit:function(e,t){var n=this;if(_()){var r=O();for(var i in D(n),r){var a=r[i];for(var o in a)a[o]&&n.register({namespace:i,name:o,multiCallback:!0})}n._readyResolve()}else t()},beforeInvoke:L}:{beforeRegister:function(e,t){if(this.isInYoda){var n=e||{},i=n.namespace,a=n.name,o=d[i];o&&("kwai"===o&&"emit"===a&&(e.before=function(e){return e&&"object"===r(e.data)&&null!==e.data&&(e.data=JSON.stringify(e.data)),e}),e.namespace=o)}t()},afterRegister:function(e){var t=this;if(t.isInYoda){var n=e||{},r=n.namespace,i=n.name,a=p[r];a&&(t[a]=t[a]||{},t[a][i]=t[r][i])}},beforeInvoke:L};e.exports=j},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){!function(e){"use strict";var t,r,i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function o(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function c(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{var n=null===console||void 0===console?void 0:console.error;return n&&n.call.apply(n,c([console],e))}catch(e){return}}function l(e){for(var t={},n=0,r=e.split("&");n<r.length;n++){var i=r[n].split("="),a=i[0],o=i[1];a in t?t[a]instanceof Array?t[a].push(o):t[a]=[t[a],o]:t[a]=o}return t}function d(e){void 0===e&&(e=location.href);var t=e.lastIndexOf("?");return-1===t?{page:e}:{page:e.slice(0,t),params:l(e.slice(t+1))}}!function(e){e.CLICK="CLICK",e.DOUBLE_CLICK="DOUBLE_CLICK",e.TRIPLE_CLICK="TRIPLE_CLICK",e.LONG_PRESS="LONG_PRESS",e.PULL="PULL",e.DRAG="DRAG",e.SCALE="SCALE",e.PULL_DOWN="PULL_DOWN",e.PULL_UP="PULL_UP",e.AUTO="AUTO"}(t||(t={})),function(e){e.PV="PV",e.SHOW="SHOW",e.VIDEO="VIDEO",e.CUSTOM="CUSTOM",e.CUSTOM_EVENT="CUSTOM_EVENT",e.RADAR="RADAR"}(r||(r={}));var p,f=(p="",function(){if(p)return p;try{var e=window.devicePixelRatio||1,t=Math.floor(screen.width*e),n=Math.floor(screen.height*e);return p=t+"x"+n}catch(e){return""}});function h(){var e=window.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history}var m={},v=function(e){try{if(window&&window.localStorage&&"undefined"!=typeof Storage&&window.localStorage instanceof Storage){var t=Number(function(e){try{if(window&&window.localStorage){var t=window.localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(e){return t}}}catch(e){return null}return null}(e))||0;return t+1>1e8&&(t=0),function(e,t){try{window&&window.localStorage&&window.localStorage.setItem(e,JSON.stringify(t))}catch(e){return!1}}(e,t+1),t}}catch(e){}return m[e]||(m[e]=0),m[e]++};function g(e,t,n){var r={};if(e.length>0)for(var i=t?decodeURIComponent:function(e){return e},a=e.split(/;\s/g),o=null,s=null,c=null,u=0,l=a.length;u<l;u++){if(null!==(c=a[u].match(/([^=]+)=/i)))try{o=decodeURIComponent(c[1]),s=i(a[u].substring(c[1].length+1))}catch(e){}else o=decodeURIComponent(a[u]),s="";null!==o&&(r[o]=s)}return r}var y,_={};function w(e,t,n){void 0===t&&(t={}),void 0===n&&(n=!1);try{if(!n&&e in _)return _[e];if(!(null===window||void 0===window?void 0:window.document))return;var r=document.cookie||"";return r===y?_[e]:(y=r,(_=g(r,!t.raw))[e])}catch(e){}}var b,S={getCookie:w,setCookie:function(e,t,n){void 0===n&&(n={});try{document.cookie=function(e,t,n,r){void 0===r&&(r={});var i=encodeURIComponent(e)+"="+(n?encodeURIComponent(t):t),a=r.expires,o=r.path||"/",s=r.domain||"";return a instanceof Date&&(i+="; expires="+a.toUTCString()),"number"==typeof a&&(i+="; max-age=="+a),""!==o&&(i+="; path="+o),""!==s&&(i+="; domain="+s),!0===r.secure&&(i+="; secure"),i}(e,t,!n.raw,n),_[e]=t}catch(e){}},parseCookieString:g},k=function(e,n,r,i){void 0===e&&(e=t.CLICK),void 0===n&&(n={}),"string"!=typeof e&&(e=e.type),e=e.toUpperCase();var a={};return"string"==typeof n?(a.contentPackage=i,"CUSTOM"===e?(a.key=n,a.value=r):(a.params=r,"PV"===e?a.page=n:a.action=n)):a=n,[e,a]},E=null,x="tool",O=!1,P=function(e){return void 0===e&&(e=b||"undefined"!=typeof window&&window.yoda),b&&b.isInYoda?b:e&&e.isInYoda?b=e:null},T=function(){return o(void 0,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:if(!b||O)return[2];e.label=1;case 1:return e.trys.push([1,6,,7]),E?[4,E]:[3,3];case 2:return e.sent(),[3,5];case 3:return[4,E=b.ready()];case 4:e.sent(),b.register({namespace:"webview",name:"getPageLoadData"}),b.register({namespace:"tool",name:"setClientLog"}),b.register({namespace:"tool",name:"sendRadarLog"}),b.register({namespace:"tool",name:"sendSummarizedLog"}),b.register({namespace:"tool",name:"getKswitchData"}),e.label=5;case 5:return E=null,O=!0,[3,7];case 6:return e.sent(),[3,7];case 7:return[2]}}))}))},I=function(e,t){return void 0===t&&(t="tool"),o(void 0,void 0,void 0,(function(){var n,r,i;return s(this,(function(a){switch(a.label){case 0:return n=!1,b?O?[3,2]:[4,T()]:[3,5];case 1:a.sent(),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,b.tool.canIUse({namespace:t,name:e})];case 3:return r=a.sent().canUse,n=r,[3,5];case 4:return i=a.sent(),u("[error 206]","yoda.tool.canIUse({ '"+t+"', '"+e+"' }) 报错: "+i.message),[3,5];case 5:return[2,n]}}))}))},C=function(e,t){return o(void 0,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return b?O?[3,2]:[4,T()]:[2];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,b[x].setClientLog({type:e,data:t},(function(n,r){n&&1!==n.result&&u("[error 203]","yoda.tool.setClientLog 埋点发送失败",JSON.stringify({type:e,data:t}),"result: "+n+", message: "+r)}))];case 3:return[2,r.sent()];case 4:return n=r.sent(),u("[error 209]","yoda."+x+".setClientLog() 报错: "+n.message),[3,5];case 5:return[2]}}))}))},L={isSupportBridgeLog:function(){return o(void 0,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return b?[4,I(e="setClientLog","tool")]:[2,!1];case 1:return t.sent()?(x="tool",[2,!0]):[4,I(e,"platform")];case 2:return t.sent()?(x="platform",[2,!0]):[2,!1]}}))}))},isSupportBridge:I,getWebviewLoadPerf:function(e){return void 0===e&&(e={}),o(void 0,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return b?O?[3,2]:[4,T()]:[2];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,null===(t=b.webview)||void 0===t?void 0:t.getPageLoadData(e)];case 3:return[2,n.sent()];case 4:return u("[error 207]","yoda.webview.getPageLoadData() 报错: "+n.sent().message),[3,5];case 5:return[2]}}))}))},sendRadarLog:function(e){return void 0===e&&(e={}),o(void 0,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return b?O?[3,2]:[4,T()]:[2];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,null===(t=b.tool)||void 0===t?void 0:t.sendRadarLog(e,(function(t,n){t&&1!==t.result&&u("[error 205]","yoda.tool.sendRadarLog 埋点发送失败",JSON.stringify(e),"result: "+t+", message: "+n)}))];case 3:return[2,n.sent()];case 4:return u("[error 207]","yoda.tool.sendRadarLog() 报错: "+n.sent().message),[3,5];case 5:return[2]}}))}))},setClientLog:C,initYoda:T,yodaAlready:O,getKDSWebviewLoadPerf:function(e){return void 0===e&&(e={}),o(void 0,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return b?O?[3,2]:[4,T()]:[2];case 1:n.sent(),n.label=2;case 2:return[4,I("getPageLoadData","system")];case 3:if(!n.sent())return[3,7];n.label=4;case 4:return n.trys.push([4,6,,7]),[4,null===(t=b.system)||void 0===t?void 0:t.getPageLoadData(e)];case 5:return[2,n.sent()];case 6:return u("[error 212]","yoda.system.getPageLoadData() 报错",n.sent().message),[3,7];case 7:return[2]}}))}))},sendSummarizedLog:function(e){return void 0===e&&(e={}),o(void 0,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:if(!b)return[2];n.label=1;case 1:return n.trys.push([1,5,,6]),O?[3,3]:[4,T()];case 2:n.sent(),n.label=3;case 3:return[4,null===(t=b.tool)||void 0===t?void 0:t.sendSummarizedLog(e)];case 4:return[2,n.sent()];case 5:return u("[error 208]","yoda.tool.sendSummarizedLog() 报错: "+n.sent().message),[3,6];case 6:return[2]}}))}))}},A=function(e,t,n){return u("[error 400]","埋点上报接口请求报错","\nurl:",t,"\ndata",n,"\nerror:",e||"server decode log failed")};function N(e,t){var n=e.url,r=e.data,i=e.timeout,a=new XMLHttpRequest;a.open("POST",n),a.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),"object"!=typeof r||r instanceof Uint8Array||(r=JSON.stringify(r)),i&&(a.timeout=i),a.onload=function(){var e=function(e,t,n,r){var i;if(e<200||e>=300&&304!==e);else try{var a=JSON.parse(t),o=a.exception,s=a.result,c=a.error_msg;o&&(i=o),1!==s&&(i=c||"result is "+s)}catch(e){i=e.message}return i&&A(i,n,r),i}(a.status,a.response,n,r);t&&t(e)},a.ontimeout=a.onerror=function(e){e&&A(e,n,r),t&&t(e?"networkTimeout":"")},a.send(r)}var R,D,j=function(e){function t(t,n,r){var i=e.call(this,{},n)||this;if("string"==typeof t){var a=d(t);i.page=a.page,i.params=a.params}else i.page=(t||{}).page||"",i.params=(t||{}).params||void 0;return i.identity=i.generatePageId(),r&&"string"==typeof t&&i.init(t,r),i}return function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.init=function(e,t){void 0===t&&(t={});var n=function(e,t){var n=e.url,r=e.page,i=e.params,a=e.pageId;if(!r&&"string"==typeof n){var o=d(n);r=o.page,i=o.params}if("function"==typeof t)try{var s=t({url:n,page:r,params:i});"string"==typeof s?r=s:"object"==typeof s&&(s.page&&(r=s.page),s.params&&(i=s.params),s.pageId&&(a=s.pageId))}catch(e){}else if("object"==typeof t){var c="";for(var u in t)if((n||r||"").indexOf(u)>-1){c=t[u];break}c&&(r=c)}return{page:r,params:i,pageId:a}}({url:e,page:this.page,params:this.params},t),r=n.page,i=n.params;this.update(r,i)},t.prototype.attachUrl=function(){if(this.params||(this.params={}),null===location||void 0===location?void 0:location.href){this.params.origin_url=this.params.origin_url||(null===location||void 0===location?void 0:location.href);var e=d(location.href).page,t=void 0===e?"":e;this.params.origin_pathname=t}},t.prototype.getRealUrlPackage=function(){var e=d(location.href),t=e.page,n=e.params;return{page:t,params:JSON.stringify(a({page_code:this.page,url:location.href,query:n},n)),page_type:this.page_type,identity:this.identity}},t.prototype.generatePageId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},t}(function(){function e(e,t){switch(this.page="",this.identity="",t){case"web":this.page_type=2;break;case"native":this.page_type=1;break;case"mina":this.page_type=3;break;default:this.page_type=0}this.update(e.page,e.params)}return e.prototype.update=function(e,t){void 0===e&&(e=""),e&&e!==this.page&&(this.page=e,this.identity=this.generatePageId(e)),t&&(this.params=Object.assign(this.params||{},t))},e.prototype.toJSON=function(){return{page:this.page,identity:this.identity,page_type:this.page_type,params:JSON.stringify(this.params)}},e.prototype.generatePageId=function(e){return e+(new Date).getTime()},e}()),M=null===(R=null===window||void 0===window?void 0:window.navigator)||void 0===R?void 0:R.platform,U=M&&-1!==["iOS","Android"].indexOf(M),B=0;try{var K=n(4);D=P(K.default||K)}catch(e){D=P("undefined"!=typeof window&&window.yoda)}var V=function(){function e(e,t){this.version="3.9.50",this.plugins={},this.yoda=D,this.entered="",this.logConfig=e,this.baseOption=t,this.commonPackage=new W(t),this.updateCurrentUrlPackage(),this.addPlugins()}return Object.defineProperty(e.prototype,"Utils",{get:function(){return{yoda:this.yoda&&L,cookie:S,ua:{getDefaultKpn:function(){return w("kpn")},supportsPushState:h},io:{sendData:N}}},enumerable:!1,configurable:!0}),e.prototype.addPlugins=function(){var e=this;this.logConfig.plugins&&this.logConfig.plugins.length&&this.logConfig.plugins.forEach((function(t){"object"==typeof t&&"function"==typeof t.apply&&e.addPluginInstance(t)}))},e.prototype.addPluginInstance=function(e){if(e){var t=e.key||e.constructor&&e.constructor.key||"plugin_auto_key_"+B++;"function"!=typeof e.apply||e.weblog&&e.weblog===this||e.apply(this),this.plugins[t]=e}},e.prototype.plug=function(e,t){if(this.plugins[e.key])return u("[code 301]",e.key+" 插件重复加载！");this.addPluginInstance(new e(this,t))},e.prototype.collect=function(e,t,n,r){var i=k(e,t,n,r),a=i[0],o=i[1];return this.send(a,o,!1)},e.prototype.sendImmediately=function(e,t,n,r){var i=k(e,t,n,r),a=i[0],o=i[1];return this.send(a,o,!0)},e.prototype.beforeSend=function(e,t){var n;if("CLICK"===e){var r=null===(n=t)||void 0===n?void 0:n.entryTag;if(this.yoda&&r)try{!function(e,t){o(void 0,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return b?O?[3,2]:[4,T()]:[2];case 1:i.sent(),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,null===(r=b.tool)||void 0===r?void 0:r.handleEntryTag({type:e,params:t})];case 3:return(n=i.sent())&&n.data&&n.data.entryTag?[2,n.data.entryTag]:[3,5];case 4:return u("[error 213]","操作染色参数报错",i.sent()),[3,5];case 5:return[2,null]}}))}))}("setPendingEntryTag",{entryTag:a({page_name:this.currentUrlPackage.page,element_action:null==t?void 0:t.action},r)})}catch(e){u("[error 312]","操作染色参数报错",e)}}},e.prototype.send=function(e,n,i){void 0===e&&(e=t.CLICK),void 0===n&&(n={}),e=e.toUpperCase(),this.beforeSend(e,n);var o=n,s=o.contentPackage,c=o.disablePV;if(s&&(s="string"==typeof s?s:JSON.stringify(s)),e===r.PV){var l=n,d=l.page,p=l.type,f=l.params,h=l.coPage;p||(n.type=p="enter"),"enter"===p?((d=d||this.currentUrlPackage.page)&&(this.updateCurrentUrlPackage({page:d,params:f||this.currentUrlPackage.params,force:!0}),this.entered=d),h&&(this.currentUrlPackage.coPage=h)):this.currentUrlPackage.update(d,f)}var m=!!this.currentUrlPackage.coPage,v=function(e,t){var n=t,r=n.action,i=n.params,o=n.eventId,s=n.contentPackage,c=n.currentUrlPackage,u=n.status;n.name;var l=n.feedLogCtx;switch(e){case"PV":var d=t,p=d.type,f=d.beginTime;return a(a({},c),{actionType:p,contentPackage:s,pageType:"H5",status:u||"SUCCESS",beginTime:f,eventId:o});case"SHOW":return{action:r,params:JSON.stringify(i),contentPackage:s,feedLogCtx:l,eventId:o};case"RADAR":case"CUSTOM":var h=t,m=h.key,v=h.value,g=h.biz;return{key:m,value:JSON.stringify(a(a({},v),{url_package:c})),biz:g,eventId:o};default:var y=t.type;return{action:r,params:JSON.stringify(i),contentPackage:s,type:y||"USER_OPERATION",status:u||"UNKNOWN_STATUS",operationType:e,operationDirection:"UNKNOWN2",feedLogCtx:l,eventId:o}}}(e,a(a({},n),{contentPackage:s,currentUrlPackage:this.currentUrlPackage.toJSON()})),g=-1!==[r.CUSTOM,r.RADAR,r.CUSTOM_EVENT].indexOf(e);this.commonPackage.increaseH5SeqId(g);var y=this.baseOption||{},_=y.service_name,w=y.sub_biz,b=y.need_encrypt;if(v.h5ExtraAttr=JSON.stringify(this.commonPackage.getH5ExtraAttr({bridge_info:(null==D?void 0:D.version)||!0,coPage:m})),v.realtime=!!i,v.serviceName=_||"",v.subBiz=w||"",v.needEncrypt=b||!1,v.container=U?"REACT_NATIVE":"H5",v.coPage=m,e!==r.PV){if(!this.currentUrlPackage||this.logConfig.disablePV||c||(v.urlPage={page:this.currentUrlPackage.page,params:JSON.stringify(this.currentUrlPackage.params),identity:this.currentUrlPackage.identity,coPage:m}),e===r.SHOW)return C("addElementShowEvent",v);if(g){this.logConfig.biz&&!v.biz&&(v.biz=this.logConfig.biz);var S=this.logConfig.customStatToCustom||e===r.CUSTOM_EVENT;return C(S?"addCustomEvent":"addCustomStatEvent",v)}return C("addTaskEvent",v)}this.logConfig.disablePV||function(e){return!e||!/^(https?:)?\/\//.test(e)||(u("[error 108]","请注意当前埋点页面信息为 "+e+"，不符合规范，上报失败！"),!1)}(this.currentUrlPackage.page)&&("enter"!==(p=n.type)&&"visible"!==p||(v.pageType=U?"NATIVE":"H5",C("setCurrentPage",v)))},e.prototype.updateCurrentUrlPackage=function(e,t){if(void 0===e&&(e="undefined"!=typeof location?location.href:""),void 0===t&&(t="web"),"object"==typeof e&&!e.force&&this.currentUrlPackage){var n=e.page,r=void 0===n?this.currentUrlPackage.page:n,i=e.params,a=void 0===i?{}:i;if(!r||r===this.currentUrlPackage.page)return this.entered===r?void this.send("PV",{type:"visible",page:r,params:a},!0):void this.currentUrlPackage.update(r,a)}this.currentUrlPackage=new j(e,t,this.logConfig.urlMap),this.logConfig.attachUrl&&this.currentUrlPackage.attachUrl()},e.prototype.updateReferUrlPackage=function(e,t){void 0===e&&(e=this.currentUrlPackage),void 0===t&&(t="web"),this.referUrlPackage=e instanceof j?e:new j(e,t,this.logConfig.urlMap)},e.prototype.flush=function(){},e.prototype.on=function(){},e.prototype.emit=function(){},e.prototype.updateCommonPackage=function(e){(null==e?void 0:e.h5_extra_attr)&&Object.assign(this.commonPackage.h5_extra_attr,e.h5_extra_attr)},e}(),W=function(){function e(e){this.h5_extra_attr={sdk_name:"webLogger",sdk_version:"3.9.50",sdk_bundle:"log.bridge.js",host_product:w("kpn"),resolution:f(),domain:window.location.origin,app_version_name:w("appver")||""},this.app_package={version_name:this.h5_extra_attr.app_version_name,container:U?"REACT_NATIVE":"H5"},Object.assign(this.h5_extra_attr,null==e?void 0:e.h5_extra_attr)}return e.prototype.increaseH5SeqId=function(e){this.h5_extra_attr.client_timestamp=function(e){try{return Math.abs(Math.floor(e))}catch(t){return e}}(Date.now()),this.h5_extra_attr.seq_id=v(e?"WEBLOGGER_H5_CUSTOM_SEQ_ID":"WEBLOGGER_H5_SEQ_ID")},e.prototype.getH5ExtraAttr=function(e){return Object.assign({},this.h5_extra_attr,e)},e}(),F=function(){function e(){}return e.prototype.apply=function(e){this.weblog=e},e}();"undefined"!=typeof window&&(void 0!==window._GLOBAL_KS_WEBLOGGER_?window._GLOBAL_KS_WEBLOGGER_.Factory=V:window.Weblog=V),e.BasePlugin=F,e.Weblog=V,e.default=V,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){e.exports=function(){"use strict";var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};function t(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function r(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function i(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))}function a(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function o(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{var n=null===console||void 0===console?void 0:console.warn;return n&&n.call.apply(n,o([console],e))}catch(e){return}}function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{var n=null===console||void 0===console?void 0:console.error;return n&&n.call.apply(n,o([console],e))}catch(e){return}}function u(e,t,n,r){return"attachEvent"in e?e.attachEvent("on"+t,n):e.addEventListener(t,n,r)}function l(e,t,n,r){return"attachEvent"in e?e.detachEvent("on"+t,n):e.removeEventListener(t,n,r)}function d(e){for(var t={},n=0,r=e.split("&");n<r.length;n++){var i=r[n].split("="),a=i[0],o=i[1];a in t?t[a]instanceof Array?t[a].push(o):t[a]=[t[a],o]:t[a]=o}return t}function p(e){var t="";if("string"==typeof e)t=e;else try{t=JSON.stringify(e)}catch(n){t=String(e)}for(var n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);n+=i<128?1:i<2048?2:i<65536?3:i<1<<21?4:i<1<<26?5:i<1<<31?6:Number.NaN}return n}var f,h,m,v=function(){function e(){}return e.prototype.apply=function(e){this.weblog=e},e}(),g=function(){var e="undefined"!=typeof window?window.performance:null;if(e&&e.timing){if("function"==typeof e.timing.toJSON){var t=e.timing.toJSON();return t&&!t.redirectStart&&(t.redirectStart=t.navigationStart),t}return e.timing}return null},y="radar_log";!function(e){e.LOAD="load",e.RES="resource",e.API="api",e.ERROR="error",e.SDK_ERROR="sdk_error",e.CUSTOM="custom",e.BATCH="batch",e.EVENT="event"}(f||(f={})),function(e){e.LOAD="load_statistics",e.RES="resource_statistics",e.API="api_statistics",e.ERROR="error_statistics",e.SDK_ERROR="sdk_error",e.CUSTOM="custom_statistics"}(h||(h={})),function(e){e.SCRIPT="script",e.RES="res",e.API="api",e.VIDEO="video"}(m||(m={}));var _,w,b={redirect:{end:"fetchStart",start:"navigationStart"},dns:{end:"domainLookupEnd",start:"domainLookupStart"},dns_start:{end:"domainLookupEnd",start:"navigationStart"},tcp:{end:"connectEnd",start:"connectStart"},tcp_start:{end:"connectEnd",start:"navigationStart"},redirect_count:{custom:function(e,t){return t.redirectCount}},ssl:{custom:function(e,t){return 0===t.secureConnectionStart?0:t.connectEnd-t.secureConnectionStart}},ssl_start:{custom:function(e,t){return 0===t.secureConnectionStart?0:t.secureConnectionStart-t.redirectStart}},ttfb:{end:"responseStart",start:"requestStart"},trans:{end:"responseEnd",start:"responseStart"},dom_parse:{end:"domInteractive",start:"responseEnd"},dom_parse_start:{end:"domInteractive",start:"navigationStart"},blank:{end:"domLoading",start:"navigationStart"},fb:{end:"responseStart",start:"navigationStart"},dom_ready:{end:"domContentLoadedEventEnd",start:"navigationStart"},total:{end:"loadEventStart",start:"navigationStart"},resource:{end:"loadEventStart",start:"domContentLoadedEventEnd"},fp:{custom:function(){if("function"!=typeof performance.getEntries)return null;var e=performance.getEntries().filter((function(e){return"first-paint"===e.name}))[0];return e?Math.ceil(e.startTime+e.duration):null}},js_cost:{custom:function(){if("function"!=typeof performance.getEntries)return null;var e=g(),t=performance.getEntries(),n=performance.getEntries().filter((function(e){return"navigation"===e.initiatorType}))[0],r=t.filter((function(e){return"script"===e.initiatorType}))[0],i=n?n.domComplete:e.domComplete-e.navigationStart;return r&&i?i-r.fetchStart:null}},tti:{end:"domInteractive",start:"navigationStart"},protocol:{custom:function(e,t){return t.nextHopProtocol}},dom_num:{custom:function(){return"undefined"!=typeof document?document.all.length:null}}},S={fetch_start:{custom:function(e,t){return Math.round(t.fetchStart)}},dns:{end:"domainLookupEnd",start:"domainLookupStart",cachedSkip:!0},tcp:{end:"connectEnd",start:"connectStart",cachedSkip:!0},ssl:{cachedSkip:!0,custom:function(e,t){return 0===t.secureConnectionStart?0:t.connectEnd-t.secureConnectionStart}},ttfb:{end:"responseStart",start:"requestStart",cachedSkip:!0},trans:{end:"responseEnd",start:"responseStart",cachedSkip:!0},fb:{end:"responseStart",start:"fetchStart",cachedSkip:!0},total:{end:"responseEnd",start:"fetchStart"},duration:{end:"responseEnd",start:"fetchStart"},size:{cachedSkip:!0,custom:function(e,t){return t.encodedBodySize},noThrottle:!0},protocol:{custom:function(e,t){return t.nextHopProtocol}},file:{custom:function(e,t){return t.name},noThrottle:!0},res_type:{custom:function(e,t){return t.initiatorType}},cached:{custom:function(e,t){return 0===t.transferSize||null==t.transferSize&&0===t.domainLookupStart},noThrottle:!0}},k={fetch_start:{custom:function(e,t){return Math.round(t.fetchStart)},noThrottle:!0},dns:{end:"domainLookupEnd",start:"domainLookupStart",cachedSkip:!0},tcp:{end:"connectEnd",start:"connectStart",cachedSkip:!0},ssl:{cachedSkip:!0,custom:function(e,t){return 0===t.secureConnectionStart?0:t.connectEnd-t.secureConnectionStart}},ttfb:{end:"responseStart",start:"requestStart",cachedSkip:!0},trans:{end:"responseEnd",start:"responseStart",cachedSkip:!0},fb:{end:"responseStart",start:"fetchStart",cachedSkip:!0},total:{end:"responseEnd",start:"fetchStart"},duration:{end:"responseEnd",start:"fetchStart"},size:{cachedSkip:!0,custom:function(e,t){return t.encodedBodySize},noThrottle:!0},protocol:{custom:function(e,t){return t.nextHopProtocol}},file:{custom:function(e,t){return t.name},noThrottle:!0},res_type:{custom:function(e,t){return t.initiatorType}},cached:{custom:function(e,t){return 0===t.transferSize||null==t.transferSize&&0===t.domainLookupStart},noThrottle:!0}},E=["//wlog.kuaishou.com/rest/n/log/web/collect","/rest/wd/common/log/collect/misc2","/rest/wd/common/log/collect/radar","/rest/kd/log/collect"],x={to_webview_page_start:{end:"pageStart",start:"userStart"},to_webview_page_show:{end:"pageShow",start:"userStart"},to_webview_pre_create:{end:"preCreate",start:"userStart"},to_webview_created:{end:"created",start:"userStart"},to_webview_start_load:{end:"startLoad",start:"userStart"},to_webview_did_start_load:{end:"didStartLoad",start:"userStart"},to_webview_did_end_load:{end:"didEndLoad",start:"userStart"},to_navigation_start:{end:"navigationStart",start:"userStart"},to_fetch_start:{end:"fetchStart",start:"userStart"},to_connect_start:{end:"connectStart",start:"userStart"},to_dom_ready:{end:"domContentLoadedEventEnd",start:"userStart"},to_total:{end:"loadEventStart",start:"userStart"},to_fmp:{end:"radarFmp",start:"userStart",notCatchIfUndefined:!0},to_main_data_receive_end:{end:"main_data_receive_end",start:"userStart",notCatchIfUndefined:!0}},O={navigation_start_time:"navigationStart",fetch_start_time:"fetchStart",dns_start_time:"domainLookupStart",dns_end_time:"domainLookupEnd",connect_start_time:"connectStart",ssl_start_time:"secureConnectionStart",request_start_time:"requestStart",response_start_time:"responseStart",response_end_time:"responseEnd",dom_interactive_time:"domInteractive",dom_loading_time:"domLoading",dom_ready_time:"domContentLoadedEventEnd",load_event_time:"loadEventStart",fmp_time:"radarFmp"},P=function(){return"".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)},T=function(e){return{name:e,value:arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,delta:0,entries:[],id:P(),isFinal:!1}},I=function(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var n=new PerformanceObserver((function(e){return e.getEntries().map(t)}));return n.observe({type:e,buffered:!0}),n}}catch(e){}},C=!1,L=!1,A=function(e){C=!e.persisted},N=function(){addEventListener("pagehide",A),addEventListener("beforeunload",(function(){}))},R=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];L||(N(),L=!0),addEventListener("visibilitychange",(function(t){var n=t.timeStamp;"hidden"===document.visibilityState&&e({timeStamp:n,isUnloading:C})}),{capture:!0,once:t})},D=function(e,t,n,r){var i;return function(){n&&t.isFinal&&n.disconnect(),t.value>=0&&(r||t.isFinal||"hidden"===document.visibilityState)&&(t.delta=t.value-(i||0),(t.delta||t.isFinal||void 0===i)&&(e(t),i=t.value))}},j=function(){return void 0===_&&(_="hidden"===document.visibilityState?0:1/0,R((function(e){var t=e.timeStamp;return _=t}),!0)),{get timeStamp(){return _}}},M=function(){return w||(w=new Promise((function(e){return["scroll","keydown","pointerdown"].map((function(t){addEventListener(t,e,{once:!0,passive:!0,capture:!0})}))}))),w},U=/^(https?:)?\/\//;function B(e){return"number"==typeof e?e.toFixed():e}function K(e){if("string"!=typeof e)return"";try{var t=e.lastIndexOf(".");return e.substr(t+1)}catch(e){return""}}function V(e,t){if(!e)return!1;var n=e.replace(U,"");return t.some((function(e){return n.indexOf(e)>=0}))}var W={};function F(e,t){var n=W[e];n?n.endTime||(n.endTime=(new Date).getTime(),n.duration=n.endTime-n.startTime,delete n.startTime,delete n.endTime):W[e]={startTime:(new Date).getTime()}}var q={},J=[{name:"fid",collectFn:function(e){var t=T("FID"),n=j(),r=function(e){e.startTime<n.timeStamp&&(t.value=e.processingStart-e.startTime,t.entries.push(e),t.isFinal=!0,a())},i=I("first-input",r),a=D(e,t,i);i?R((function(){i.takeRecords().map(r),i.disconnect()}),!0):window.perfMetrics&&window.perfMetrics.onFirstInputDelay&&window.perfMetrics.onFirstInputDelay((function(e,r){r.timeStamp<n.timeStamp&&(t.value=e,t.isFinal=!0,t.entries=[{entryType:"first-input",name:r.type,target:r.target,cancelable:r.cancelable,startTime:r.timeStamp,processingStart:r.timeStamp+e}],a())}))}},{name:"lcp",collectFn:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=T("LCP"),i=j(),a=function(e){var n=e.startTime;n<i.timeStamp?(r.value=n,r.entries.push(e)):r.isFinal=!0,t()},o=I("largest-contentful-paint",a);if(o){t=D(e,r,o,n);var s=function(){r.isFinal||(o.takeRecords().map(a),r.isFinal=!0,t())};M().then(s),R(s,!0)}}},{name:"cls",collectFn:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=T("CLS",0),i=function(e){e.hadRecentInput||(r.value+=e.value,r.entries.push(e),t())},a=I("layout-shift",i);a&&(t=D(e,r,a,n),R((function(e){var n=e.isUnloading;a.takeRecords().map(i),n&&(r.isFinal=!0),t()})))}},{name:"fcp",collectFn:function(e){var t,n=T("FCP"),r=j(),i=I("paint",(function(e){"first-contentful-paint"===e.name&&e.startTime<r.timeStamp&&(n.value=e.startTime,n.isFinal=!0,n.entries.push(e),t())}));i&&(t=D(e,n,i))}}],H=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];1==+d(location.search.slice(1)).debug&&s.apply(void 0,o(["[radar] "+e+": "],t))},z=function(){var e=window.navigator.userAgent,t={};return e.split(" ").map((function(e){var n=e.split("/");t[n[0]]=n[1]})),t},Y=function(){var e=window.navigator.userAgent;if(-1!==e.indexOf("Android"))return"WebView";if(-1!==e.indexOf("iPhone")){var t=z();return t.Yoda&&"WK"===t.WebViewType?"YodaWKWebView":t.Yoda||"WKWebView"!==t.WebView?"UIWebView":"WKWebView"}return""},G=function(e,t){var n={};return Object.keys(t).forEach((function(r){e[t[r]]>=0&&(n[r]=B(e[t[r]]))})),n};function Q(e){return Array.isArray(e)?e.map((function(e){var t=e.tagName,n=void 0===t?"":t,r=e.id,i=e.getAttribute?e.getAttribute("class"):e.className||"",a=n.toLowerCase();return r&&(a+="#"+r),i&&(a+=i.split(/\s+/g).map((function(e){return"."+e})).join("")),a})).filter((function(e){return e})).join(","):""}function X(e){return JSON.parse(JSON.stringify(e))}var $=function(e){try{if(window&&window.localStorage&&"undefined"!=typeof Storage&&window.localStorage instanceof Storage){var t=Number(function(e){try{if(window&&window.localStorage){var t=window.localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(e){return t}}}catch(e){return null}return null}(e))||0;return t+1>1e8&&(t=0),function(e,t){try{window&&window.localStorage&&window.localStorage.setItem(e,JSON.stringify(t))}catch(e){return!1}}(e,t+1),t}}catch(e){}},Z={},ee=function(e){return Z[e]||(Z[e]=0),Z[e]++};function te(e){if(!(null==e?void 0:e.name))throw new Error("[Radar] 关键动作上报必须配置name");if((null==e?void 0:e.extra_info)&&!(e.extra_info instanceof Object))throw new Error("[Radar] 关键动作上报 extra_info 必须为 plain object")}function ne(e,t){if(!Array.isArray(t))return-1;var n=-1;return t.forEach((function(t,r){new RegExp(t).test(e)&&(n=r)})),n}var re,ie,ae=function(){function e(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.middlewares=[],(e=this.middlewares).push.apply(e,t)}return e.prototype.use=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this.middlewares.pop();(e=this.middlewares).push.apply(e,t),this.middlewares.push(r)},e.prototype.invoke=function(e){var t;return(t=this.middlewares,function(e,n){var r=-1;return function i(a){if(a<=r)return new Error("`next` 被重复调用");r=a;var o=t[a];if(a===t.length&&(o=n),o)try{return o(e,i.bind(null,a+1))}catch(e){return e}}(0)})(e)},e}(),oe=["KUAISHOU","THANOS","NEBULA"],se=function(e){function r(t,r){var i,a,s=e.call(this)||this;return s.kpn="",s.plugins=[],s.logQueue=[],s.logQueueNext=[],s.queueConfig={wait:1e3,maxBatchLength:200},s.eventName="onpagehide"in window?"pagehide":"beforeunload",s.batchTimer=0,s.batchTimerNext=0,s.startedLoadReport=!1,s.radarSessionId="",s.radarSessionIdNext="",s.chromeMetric=J,s.isInKwai=!1,s.isUsingBridge=null,s.isUsingLegacy=null,s.isUsingDetachedReport=null,s.isSupportedYodaConcat=null,s.customDimension={},s.webviewData=null,s.webviewStart=null,s.webviewStartTime=null,s.finalSampling={},s.sampleData=null,s.sampleList=[f.LOAD,f.API,f.CUSTOM,f.ERROR,f.EVENT,f.RES],s.defaultSampleList={load:1,api:1,resource:.1,error:1,event:1,custom:1,isHit:!0},s.ignoreList=["https://web-trace.ksapisrv.com/ktrace/collect"],s.lastRadarLogId="",s.computedSamplingAgain=!0,s.realSampledList=[],s.hasFmp=!1,s.customPerfList={},s.mainApiList=[],s.mainApiResult=[],s.observeResource=function(e){e.getEntriesByType("resource").forEach((function(e){return s.reportPerformance(e)}))},s.asyncReportTiming=function(){F("radarCreatedToOnload"),F("onloadToFirstReport"),setTimeout((function(){F("asyncReportTiming"),s.reportPerformance(g()),s.startedLoadReport=!0;try{s.observeResource(performance),s.observeChromeMetrics(s.chromeMetric),new PerformanceObserver(s.observeResource).observe({entryTypes:["resource"]})}catch(e){}F("radarCreatedToFirstReport"),F("onloadToFirstReport"),F("asyncReportTiming")}),0)},s.chromeMetricCallback=function(e){var t,n,r=e.name,i=e.value;r=r.toLocaleLowerCase();var a={key:f.CUSTOM,value:(t={},t[r]=i,t)};s.logCollect(a),s.logCollectNext({key:f.EVENT,dimension:{name:r},value:{duration:i}}),F(r+"Collect"),function(e){Object.assign(q,e)}(((n={})[r]=i,n))},s.observeChromeMetrics=function(e){var t=s.options;e.forEach((function(e){var n=e.name;t&&!t[n]||(F(n+"Collect"),e.collectFn(s.chromeMetricCallback))}))},s.asyncMetricCollectDone=function(){var e={};Object.keys(W).forEach((function(t){var n=W[t];!n.duration&&n.startTime&&(n.duration=0,delete n.startTime),e[t]=n.duration}));var t={key:f.CUSTOM,value:e};s.logCollect(t),s.flush(),s.weblog.flush(),l(window,s.eventName,s.asyncMetricCollectDone)},s.flush=function(){if(s.beforeFlush(),s.options&&!(s.logQueue.length<=0)&&s.startedLoadReport){var e=JSON.stringify(n(n({},s.weblog.commonPackage.getH5ExtraAttr()),{url:location.href,hash:location.hash,webviewStart:s.webviewStart,webviewStartTime:s.webviewStartTime,sampling_list:s.finalSampling?JSON.stringify(s.finalSampling):""})),t={project_id:s.options.projectId,radar_session_id:s.radarSessionId,h5_extra_attr:e},r=s.weblog.commonPackage,i=r.service_name,a=r.sub_biz,c=r.need_encrypt,u=r.app_package,l=s.currentUrlPackage&&s.currentUrlPackage.toJSON(),d=null;s.options.httpReportFirst||(d=s.addRadarStatEvent({key:y,value:n(n({},t),{data:o(s.logQueue),url_package:l,app_version_name:u.version_name}),serviceName:i||"",subBiz:a||"",needEncrypt:c||!1,container:u.container,realtime:!1,h5ExtraAttr:e})),d&&!s.options.httpReportFirst||s.weblog.collect("RADAR",{name:y,params:n(n({},t),{data:o(s.logQueue)}),currentUrlPackage:l,referUrlPackage:s.referUrlPackage&&s.referUrlPackage.toJSON(),serviceName:i||"radar_service_name"}),s.logQueue=[]}},s.flushNext=function(){if(s.options&&!(s.logQueueNext.length<=0)){var e=null;s.options.httpReportFirst||(e=s.reportByBridge()),e&&!s.options.httpReportFirst||s.reportByHttp(),s.logQueueNext=[]}},s.getCommonData=function(){var e,t,r,i=s.weblog.commonPackage.app_package,a=JSON.stringify(n(n({},s.weblog.commonPackage.getH5ExtraAttr()),{app_version_name:i.version_name,url:location.href,hash:location.hash,online:null===navigator||void 0===navigator?void 0:navigator.onLine,downlink:null===(e=null===navigator||void 0===navigator?void 0:navigator.connection)||void 0===e?void 0:e.downlink,rtt:null===(t=null===navigator||void 0===navigator?void 0:navigator.connection)||void 0===t?void 0:t.rtt})),o=s.currentUrlPackage&&s.currentUrlPackage.toJSON(),c=null===(r=s.options)||void 0===r?void 0:r.projectId;return{h5_extra_attr:a,url_package:o,app_version_name:i.version_name,project_id:c}},r&&(i=r),t&&(t.logger?s.apply(t):i=t),F("radarCreatedToFirstReport"),F("radarCreatedToOnload"),s.options=i,s.queueConfig=n(n({},s.queueConfig),s.options?s.options.queue:{}),s.options&&"string"==typeof s.options.mainApi?(s.mainApiList.push(s.options.mainApi),s.mainApiResult.push({})):s.options&&Array.isArray(s.options.mainApi)&&(s.options.mainApi.length,s.mainApiList=s.options.mainApi.slice(0,3),s.mainApiList.forEach((function(){return s.mainApiResult.push({})}))),s.ignoreList=s.ignoreList.concat((void 0===(a=s.options&&s.options.ignoreList)&&(a=[]),a.concat(E).map((function(e){return e.replace(U,"")})))),s}return t(r,e),Object.defineProperty(r.prototype,"KSwitchSampled",{get:function(){return this.weblog.currentUrlPackage.sampled},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isKSwitchSampled",{get:function(){return this.weblog.isKSwitchSampled},enumerable:!1,configurable:!0}),r.prototype.samplingControl=function(e){if(!e)return!1;var t=Math.random();return"number"==typeof e?t<e:t<e.sampling},r.prototype.use=function(e,t){var n=new e(t,this.options);this.plugins.push(n),this.weblog&&n.created()},r.prototype.apply=function(e){var t,n;this.weblog=e,this.kpn=this.weblog.Utils.ua.getDefaultKpn(),this.isInKwai=oe.indexOf(this.kpn)>=0,this.upadteUrlPackage(),this.register(),this.ignoreList.push(null===(n=null===(t=this.weblog)||void 0===t?void 0:t.logger)||void 0===n?void 0:n.url),this.created()},r.prototype.created=function(){this.plugins.forEach((function(e){e.created()}))},r.prototype.destroy=function(){l(window,"load",this.asyncReportTiming),this.plugins.forEach((function(e){e.destroy()}))},r.prototype.computedRealSampled=function(e,t){if(this.isKSwitchSampled){var n=void 0;if("object"==typeof this.KSwitchSampled&&this.KSwitchSampled.radar){var r=this.KSwitchSampled.radar.all;r="number"!=typeof r?1:r;var i=this.KSwitchSampled.radar[t];n="number"!=typeof i?r:i*r}else n=this.KSwitchSampled?1:0;return n*e}return 1},r.prototype.getWebviewData=function(){if(window.__yodaCommonDataObject__&&window.__yodaCommonDataObject__.pageLoadData){var e=null;try{var t=window.__yodaCommonDataObject__.pageLoadData;e="string"==typeof t?JSON.parse(t):t}catch(e){return}var r=e.created,i=e.pageStart,a=e.userStart;this.webviewData=n({webviewStart:a||i||r},e);var o={key:f.EVENT,value:null,dimension:{name:"客户端数据注入成功",event_type:"radar_inject_success"}};this.logCollect(o),this.logCollectNext(o)}},r.prototype.getSampleData=function(){var e=this,t=this.weblog.Utils.yoda;if(t?(this.sampleData=this.defaultSampleList,window.updateYodaSampleRateWithParams=function(t){e.updateSampleData(t),e.handleSample()}):this.handleSample(),window.__yodaCommonDataObject__&&window.__yodaCommonDataObject__.sampleData){this.updateSampleData(),this.handleSample();var n={key:f.EVENT,value:null,dimension:{name:"客户端采样率注入成功",event_type:"radar_sample_inject_success"}};this.logCollect(n),this.logCollectNext(n)}else t&&t.getWebviewLoadPerf().then((function(t){t.sampleData&&(e.updateSampleData(t.sampleData),e.handleSample())}))},r.prototype.updateSampleData=function(e){var t=this,n=null;try{var r=e||window.__yodaCommonDataObject__.sampleData;n="string"==typeof r?JSON.parse(r):r}catch(e){return}this.sampleData=this.defaultSampleList,n&&Object.keys(n).forEach((function(e){t.sampleData[e]=n[e]}))},r.prototype.register=function(){return i(this,void 0,void 0,(function(){var e,t,n;return a(this,(function(r){switch(r.label){case 0:return g()?("undefined"!=typeof window&&window.yodaCollectErrorDataDestroy&&window.yodaCollectErrorDataDestroy(),performance.timing.loadEventStart>0?this.asyncReportTiming():u(window,"load",this.asyncReportTiming),this.options&&this.options.radarCost&&u(window,this.eventName,this.asyncMetricCollectDone),u(window,this.eventName,this.flush),u(window,this.eventName,this.flushNext),this.getSampleData(),this.getWebviewData(),this.radarSessionId=this.nanoId(),this.radarSessionIdNext=this.uuid(),(e=this.weblog.Utils.yoda)?[3,1]:(this.isUsingBridge=!1,this.isSupportedYodaConcat=!1,this.isUsingLegacy=!1,[3,6])):[2];case 1:return null!=this.isUsingBridge?[3,3]:(t=this,[4,e.isSupportBridgeLog()]);case 2:t.isUsingBridge=r.sent(),r.label=3;case 3:return null!=this.isSupportedYodaConcat?[3,5]:(n=this,[4,e.isSupportBridge("sendRadarLog")]);case 4:n.isSupportedYodaConcat=r.sent(),r.label=5;case 5:this.isUsingLegacy=this.isUsingBridge&&!this.isSupportedYodaConcat,r.label=6;case 6:return this.isUsingDetachedReport=this.isInKwai&&!this.isUsingBridge||this.isUsingLegacy,[2]}}))}))},r.prototype.throttle=function(e,t,n,r){if(void 0===r&&(r={}),t.noThrottle||"number"!=typeof e)return e;var i=r.startPoint,a=r.endPoint;if(e>6e4||e<0||isNaN(e)){if(Math.random()<.1){var o="["+n+" 异常]: "+e+"，原始数据为："+t.end+": "+a+" - "+t.start+": "+i,s={key:f.EVENT,value:null,dimension:{name:"雷达数据异常",event_type:"radar_error",message:o,src:location.href,webViewType:Y(),yoda_version:z().yoda_version||""}};this.logCollect(s),this.logCollectNext(s)}return null}return Math.round(e)},r.prototype.reportPerformance=function(e){this.plugins.forEach((function(t){e&&t.when(e)&&t.onPerfReport(e)}))},r.prototype.calculate=function(e,t,n){var r=t[e];if(r){if(r.cachedSkip&&this.calculate("cached",t,n))return;if("function"==typeof r.custom){var i=r.custom(e,n);return this.throttle(i,r,e)}var a=r.end,o=r.start,s=+n[a]||performance.timing[a],u=+n[o]||performance.timing[o],l=s-u;if(!r.notCatchIfUndefined||void 0!==s&&void 0!==u)return this.throttle(l,r,e,{startPoint:u,endPoint:s})}else c("[warn 310]","[Radar] perf key "+e+" is unexpected!")},r.prototype.calculateNext=function(e,t,n){var r=t[e];if(r){if(r.cachedSkip&&this.calculateNext("cached",t,n))return;if("function"==typeof r.custom)return B(r.custom(e,n));var i=r.end,a=r.start,o=+n[i]||performance.timing[i],s=+n[a]||performance.timing[a],c=o-s;if(!r.notCatchIfUndefined||void 0!==o&&void 0!==s)return B(c)}},r.prototype.generateLog=function(e,t,n){var r=this;void 0===n&&(n=!0);var i={};return Object.keys(e).forEach((function(a){var o=a,s=n?r.calculate(o,e,t):r.calculateNext(o,e,t);null!=s&&(i[o]=s)})),i},r.prototype.subDimension=function(e){this.customDimension&&(e.dimension||(e.dimension={}),Object.assign(e.dimension,this.customDimension))},r.prototype.nanoId=function(){for(var e=1e9*Math.random()>>>0,t=[],n=0;n<7;n++)t.push("0123456789ABCDEF".charAt(16*Math.random()));return e+t.join("")},r.prototype.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},r.prototype.beforeFlush=function(){var e=this;if(this.computedSamplingAgain){var t={radarLoadSampling:{sampling:1,type:"load"},radarApiSampling:{sampling:this.options&&this.options.apiSampling||1,type:"api"},radarErrorSampling:{sampling:this.options&&this.options.errorSampling||1,type:"error"},radarResourceSampling:{sampling:this.options&&this.options.resourceSampling||.1,type:"resource"},radarCustomSampling:{sampling:this.options&&this.options.customSampling||1,type:"custom"},radarEventSampling:{sampling:this.options&&this.options.eventSampling||1,type:"event"}};this.realSampledList=[],Object.keys(t).forEach((function(n){var r=e.isKSwitchSampled?e.computedRealSampled(t[n].sampling,t[n].type):t[n],i=e.samplingControl(r);e.finalSampling[t[n].type]=r,i&&e.realSampledList.push(t[n].type)})),this.isKSwitchSampled&&(this.computedSamplingAgain=!1)}this.logQueue=this.logQueue.filter((function(t){return-1!==e.realSampledList.indexOf(t.key)}))},r.prototype.upadteUrlPackage=function(){this.weblog&&(this.computedSamplingAgain=!0,this.currentUrlPackage=this.weblog.currentUrlPackage,this.referUrlPackage=this.weblog.referUrlPackage)},r.prototype.decorateLog=function(e){this.currentUrlPackage||this.upadteUrlPackage(),this.customDimension&&this.subDimension(e),this.currentUrlPackage&&this.currentUrlPackage.page!==this.weblog.currentUrlPackage.page&&(this.flushNext(),this.flush(),this.upadteUrlPackage())},r.prototype.logCollect=function(e){var t=this;if(this.options&&!this.options.unuseOldRadar){this.decorateLog(e);try{window.dispatchEvent(new CustomEvent("get-radar-data",{detail:{kv:e}}))}catch(e){}var n=!0;if("load"===e.key)for(var r=0;r<this.logQueue.length;r++){var i=this.logQueue[r];if("load"===i.key){Object.assign(i,e),n=!1;break}}n&&this.logQueue.push(e),H("radarLog",JSON.parse(JSON.stringify(e))),this.batchTimer||(this.logQueue.length>this.queueConfig.maxBatchLength?this.flush():this.batchTimer=window.setTimeout((function(){t.flush(),clearTimeout(t.batchTimer),t.batchTimer=0}),this.queueConfig.wait))}},r.prototype.addRadarStatEvent=function(e){var t=this;try{var r=this.weblog.Utils.yoda;if(!r)return!1;var i=function(e){var t,r;if(!e.value)return e;var i=e.value,a=function(e){var t,n=[];return e.forEach((function(e){"load"===e.key?t=e:n.push(e)})),[t,n]}(i.data),o=a[0],s=a[1],c={project_id:i.project_id,app_version_name:i.app_version_name,url_package:i.url_package,h5_extra_attr:e.h5ExtraAttr};return{loadLog:o?{removeStashedLog:[],sendImmediate:null!==(r=null===(t=o.dimension)||void 0===t?void 0:t.sendImmediate)&&void 0!==r&&r,customData:n({data:[o]},c)}:null,commonLog:s.length?{removeStashedLog:[],sendImmediate:!0,customData:n({data:s},c)}:null}}(e),a=i.loadLog,o=i.commonLog;if(a){if(this.lastRadarLogId&&(a.removeStashedLog=[this.lastRadarLogId],a.sendImmediate)){var s={removeStashedLog:[this.lastRadarLogId],sendImmediate:!1,customData:{"":""}};r.sendRadarLog(s).then((function(e){e&&e.logId&&(t.lastRadarLogId=e.logId)}))}r.sendRadarLog(a).then((function(e){e&&e.logId&&(t.lastRadarLogId=e.logId)}))}return o&&r.sendRadarLog(o),!0}catch(e){return!1}},r.prototype.calculateSample=function(e){var t=(null==e?void 0:e.load)||1,n={};return e&&Object.keys(e).forEach((function(r){var i=e[r]/t;n[r]=i>1?1:i})),n},r.prototype.handleSample=function(){var e,t,n,r,i,a,o,s,c=this;this.weblog.Utils.yoda||this.sampleData||(this.sampleData={load:(null===(e=this.options)||void 0===e?void 0:e.sampling)||1,api:(null===(t=this.options)||void 0===t?void 0:t.apiSampling)||1,resource:(null===(n=this.options)||void 0===n?void 0:n.resourceSampling)||.1,error:(null===(r=this.options)||void 0===r?void 0:r.errorSampling)||1,event:(null===(i=this.options)||void 0===i?void 0:i.eventSampling)||1,custom:(null===(a=this.options)||void 0===a?void 0:a.customSampling)||1}),s=this.calculateSample(this.sampleData),o={radarLoadSampling:{sampling:1,type:"load"},radarApiSampling:{sampling:(null==s?void 0:s.api)||1,type:"api"},radarErrorSampling:{sampling:(null==s?void 0:s.error)||1,type:"error"},radarResourceSampling:{sampling:(null==s?void 0:s.resource)||.1,type:"resource"},radarCustomSampling:{sampling:(null==s?void 0:s.custom)||1,type:"custom"},radarEventSampling:{sampling:(null==s?void 0:s.event)||1,type:"event"}},this.sampleList=[],Object.keys(o).forEach((function(e){var t=o[e];c.samplingControl(t)&&c.sampleList.push(o[e].type)}))},r.prototype.logCollectNext=function(e){var t=this,r=X(e);if(this.options&&(!this.sampleData||!1!==this.sampleData.isHit)&&this.sampleList.some((function(e){return e===r.key}))){this.decorateLog(r);var i=this.getCommonData(),a=i.app_version_name;delete i.app_version_name;var o=new ae((function(e,r){return e.dimension.app_version_name=a,n(n(n({},e),i),{event_client_timestamp:Date.now(),event_trigger_source:"H5",radar_session_id:t.radarSessionIdNext})}));if(o.use((function(e,t){return e.key&&"load"===e.key&&(e.dimension=n(n({},e.dimension),{load_device_increase_id:$("LOAD_DEVICE_INCREASE_ID"),load_session_increase_id:ee("LOAD_SESSION_INCREASE_ID")})),e.key&&"load"!==e.key&&(e.dimension=n(n({},e.dimension),{other_device_increase_id:$("OTHER_DEVICE_INCREASE_ID"),other_session_increase_id:ee("OTHER_SESSION_INCREASE_ID")})),t()}),(function(e,n){return e.dimension.sample_rate=t.sampleData&&t.sampleData[e.key]||1,n()})),(r=o.invoke(r))instanceof Error)throw r;try{window.dispatchEvent(new CustomEvent("get-radar-next-data",{detail:{kv:X(r)}}))}catch(e){}delete r.dimension.broadcast_info;var s=!0;if("load"===r.key)for(var c=0;c<this.logQueueNext.length;c++){var u=this.logQueueNext[c];if("load"===u.key){Object.assign(u,r),s=!1;break}}s&&this.logQueueNext.push(r),H("radarLogNext",JSON.parse(JSON.stringify(r))),this.batchTimerNext||(this.logQueueNext.length>this.queueConfig.maxBatchLength?this.flushNext():this.batchTimerNext=window.setTimeout((function(){t.flushNext(),clearTimeout(t.batchTimerNext),t.batchTimerNext=0}),this.queueConfig.wait))}},r.prototype.reportByHttp=function(){var e,t=this.getCommonData(),n={project_id:null===(e=this.options)||void 0===e?void 0:e.projectId,radar_session_id:this.radarSessionIdNext,h5_extra_attr:t.h5_extra_attr},r=this.logQueueNext.filter((function(e){return"load"===e.key})),i=this.logQueueNext.filter((function(e){return"load"!==e.key}));Array.isArray(r)&&r.length&&this.collectLog(n,r,"radarSDK"),Array.isArray(i)&&i.length&&this.collectLog(n,i,"radarSDKSupplement")},r.prototype.collectLog=function(e,t,r){(this.weblog.sendByHttp||this.weblog.collect).call(this.weblog,"RADAR",{name:y,params:n(n({},e),{data:o(t)}),serviceName:r})},r.prototype.reportByBridge=function(){var e=this.weblog.Utils.yoda;if(!e)return!1;var t=this.logQueueNext.filter((function(e){return"load"===e.key})),n=this.logQueueNext.filter((function(e){return"load"!==e.key}));if(!t.length&&!n.length)return!0;try{if(t.length){var r=t[0];e.sendSummarizedLog({key:"h5_load",data:r})}return n.length&&e.sendRadarLog({data:n}),!0}catch(e){return!1}},r}(v),ce=function(e,t){this.radar=e,this.options=t},ue=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.key="navigation",t.logData={},t.logSended=!1,t.saveWebviewEntry={},t.hasReportBase=!1,t.record={fmp:!1,base:!1,webviewPerf:!1},t.loadTimeout=null,t.gettingWebview=!1,t.REPEAT_TIME=5,t.getWebviewTimes=t.REPEAT_TIME,t.reportOnUnload=function(e){t.logSended||t.radar.isSupportedYodaConcat||(t.logSended=!0,t.reportFirstScreen(Object.assign(t.logData,q)),t.radar.logCollect(t.data),"noflush"!==e&&(t.radar.flush(),t.radar.weblog.flush()))},t}return t(n,e),Object.defineProperty(n.prototype,"sendImmediate",{get:function(){return this.record.fmp&&this.record.base&&this.record.webviewPerf&&!(!(e=window.navigator.userAgent.match(/tbht\/([\w]+)/i))||"0"===e[1]);var e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){return this.sepDimension({key:f.LOAD,value:this.logData})},enumerable:!1,configurable:!0}),n.prototype.created=function(){return i(this,void 0,void 0,(function(){return a(this,(function(e){return[2]}))}))},n.prototype.when=function(e){if(e.custom){var t=(e.entry||{}).key;return["fmp","play_clicked","play_idr","webViewPerf"].indexOf(t)>-1}return!e.entryType||"navigation"===e.entryType},n.prototype.getWebviewLoadData=function(){return i(this,void 0,void 0,(function(){var e,t,n,r,i,o,s;return a(this,(function(a){switch(a.label){case 0:return this.record.webviewPerf?[2,!0]:(e=this.radar.weblog.Utils.yoda,(n=e)?[4,e.getWebviewLoadPerf()]:[3,2]);case 1:n=a.sent(),a.label=2;case 2:return(t=n)&&t.timeData?(this.record.webviewPerf=!0,r=t.timeData,i=r.userStart,o=r.pageStart,s=r.created,this.radar.webviewStart="userStart",this.radar.webviewStartTime=i,i||(o?(t.timeData.userStart=o,this.radar.webviewStart="pageStart",this.radar.webviewStartTime=o):(t.timeData.userStart=s,this.radar.webviewStart="created",this.radar.webviewStartTime=s)),this.onPerfReport({custom:!0,entry:{key:"webViewPerf",value:t.timeData}}),[2,!0]):[2,!1]}}))}))},n.prototype.webviewPatch=function(){return i(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return this.gettingWebview?[2]:(this.gettingWebview=!0,[4,this.repeatWebview()]);case 1:return e.sent(),this.gettingWebview=!1,[2]}}))}))},n.prototype.repeatWebview=function(){return i(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.getWebviewLoadData()];case 1:return!e.sent()&&this.getWebviewTimes>0?(this.getWebviewTimes--,[4,this.repeatWebview()]):[3,3];case 2:e.sent(),e.label=3;case 3:return this.getWebviewTimes=this.REPEAT_TIME,[2]}}))}))},n.prototype.onPerfReport=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i,o,s,c,u,l,d=this;return a(this,(function(a){if(e.custom){if((t=e.entry)&&(n=t.key,r=t.value,i=e.renderTime,"fmp"===n&&(performance.timing.radarFmp=i,this.record.fmp=!0,u=G(performance.timing,O),Object.assign(this.logData,((l={})[n]=r,l),u),this.webviewPatch(),this.record.webviewPerf&&(s=this.radar.generateLog(x,this.saveWebviewEntry),Object.assign(this.logData,s))),"webViewPerf"===n)){if(!(o=t.value))return[2];this.saveWebviewEntry=o,s=this.radar.generateLog(x,o),Object.assign(this.logData,s)}}else c=this.radar.generateLog(b,e),u=G(performance.timing,O),Object.assign(this.logData,c,u),this.record.base=!0;return this.radar.isSupportedYodaConcat?(this.webviewPatch(),this.radar.logCollect(this.data)):this.radar.isUsingDetachedReport&&this.record.webviewPerf&&this.record.fmp&&this.record.base?this.reportOnUnload("noflush"):this.record.fmp&&this.record.base&&!this.hasReportBase?(clearTimeout(this.loadTimeout),this.loadTimeout=null,this.loadReport()):!this.hasReportBase&&this.record.base&&(this.loadTimeout=setTimeout((function(){d.loadReport(),d.hasReportBase=!0}),2e3)),[2]}))}))},n.prototype.destroy=function(){clearTimeout(this.delay)},n.prototype.sepDimension=function(e){var t=e.key,n=e.value,i=n.protocol;return{key:t,value:r(n,["protocol"]),dimension:{protocol:i,sendImmediate:this.sendImmediate}}},n.prototype.reportFirstScreen=function(e){if(e.play_clicked&&e.play_idr){var t=e.play_idr-e.play_clicked;t>0&&t<6e4&&(this.logData.play_first_screen=t)}},n.prototype.loadReport=function(){Object.assign(this.logData,q),this.radar.logCollect(X(this.data)),this.radar.flush(),this.radar.weblog.flush()},n}(ce);!function(e){e.LOAD="load",e.RES="resource",e.API="api",e.ERROR="error",e.SDK_ERROR="sdk_error",e.CUSTOM="custom",e.BATCH="batch",e.EVENT="event"}(re||(re={})),function(e){e.SCRIPT="script",e.RES="res",e.API="api",e.VIDEO="video"}(ie||(ie={}));var le={redirect:{end:"redirectEnd",start:"redirectStart"},dns:{end:"domainLookupEnd",start:"domainLookupStart"},dns_start:{end:"domainLookupEnd",start:"navigationStart"},tcp:{end:"connectEnd",start:"connectStart"},tcp_start:{end:"connectEnd",start:"navigationStart"},redirect_count:{custom:function(e,t){return t.redirectCount}},ssl:{custom:function(e,t){var n=t;return t.secureConnectionStart||t.requestStart||(n=performance.timing),0===n.secureConnectionStart?0:n.requestStart-n.secureConnectionStart}},ssl_start:{custom:function(e,t){var n=t;return t.secureConnectionStart||t.requestStart||(n=performance.timing),0===n.secureConnectionStart?0:n.secureConnectionStart-n.redirectStart}},ttfb:{end:"responseStart",start:"requestStart"},request_start:{end:"requestStart",start:"navigationStart"},trans:{end:"responseEnd",start:"responseStart"},dom_parse:{end:"domInteractive",start:"responseEnd"},dom_parse_start:{end:"domInteractive",start:"navigationStart"},blank:{end:"domLoading",start:"navigationStart"},fb:{end:"responseStart",start:"navigationStart"},dom_ready:{end:"domContentLoadedEventEnd",start:"navigationStart"},total:{end:"loadEventStart",start:"navigationStart"},resource:{end:"loadEventStart",start:"domInteractive"},fp:{custom:function(){if("function"!=typeof performance.getEntries)return null;var e=performance.getEntries().filter((function(e){return"first-paint"===e.name}))[0];return e?Math.ceil(e.startTime+e.duration):null}},js_cost:{custom:function(){if("function"!=typeof performance.getEntries)return null;var e=g(),t=performance.getEntries(),n=performance.getEntries().filter((function(e){return"navigation"===e.initiatorType}))[0],r=t.filter((function(e){return"script"===e.initiatorType}))[0],i=n?n.domComplete:e.domComplete-e.navigationStart;return r&&i?i-r.fetchStart:null}},tti:{end:"domInteractive",start:"navigationStart"},protocol:{custom:function(e,t){return t.nextHopProtocol}},dom_num:{custom:function(){return"undefined"!=typeof document?document.all.length:null}}},de={fetch_start:{custom:function(e,t){return Math.round(t.fetchStart)},noThrottle:!0},dns:{end:"domainLookupEnd",start:"domainLookupStart",cachedSkip:!0},tcp:{end:"connectEnd",start:"connectStart",cachedSkip:!0},ssl:{cachedSkip:!0,custom:function(e,t){return 0===t.secureConnectionStart?0:t.requestStart-t.secureConnectionStart}},ttfb:{end:"responseStart",start:"requestStart",cachedSkip:!0},trans:{end:"responseEnd",start:"responseStart",cachedSkip:!0},fb:{end:"responseStart",start:"fetchStart",cachedSkip:!0},total:{end:"responseEnd",start:"fetchStart"},duration:{end:"responseEnd",start:"fetchStart"},size:{cachedSkip:!0,custom:function(e,t){return t.encodedBodySize},noThrottle:!0},protocol:{custom:function(e,t){return t.nextHopProtocol}},file:{custom:function(e,t){return t.name},noThrottle:!0},res_type:{custom:function(e,t){return t.initiatorType}},cached:{custom:function(e,t){return 0===t.transferSize||null==t.transferSize&&0===t.domainLookupStart},noThrottle:!0}},pe={main_api:{end:"apiEnd",start:"apiStart"},main_api_offset:{end:"apiStart",start:"domLoading"}},fe={navigation_start_time:"navigationStart",fetch_start_time:"fetchStart",dns_start_time:"domainLookupStart",dns_end_time:"domainLookupEnd",connect_start_time:"connectStart",ssl_start_time:"secureConnectionStart",request_start_time:"requestStart",response_start_time:"responseStart",response_end_time:"responseEnd",dom_interactive_time:"domInteractive",dom_loading_time:"domLoading",dom_ready_time:"domContentLoadedEventEnd",load_event_time:"loadEventStart",fmp_time:"radarFmp",connect_end_time:"connectEnd",load_event_end:"loadEventEnd",dom_complete:"domComplete",dom_content_loaded_event_start:"domContentLoadedEventStart",redirect_start:"redirectStart",redirect_end:"redirectEnd"},he={navigation_start:"startTime",redirect_start:"redirectStart",redirect_end:"redirectEnd",dns_start:"domainLookupStart",dns_end:"domainLookupEnd",connect_start:"connectStart",connect_end:"connectEnd",ssl_start:"secureConnectionStart",request_start:"requestStart",response_start:"responseStart",response_end:"responseEnd"},me={redirect_start:"redirectStart",redirect_end:"redirectEnd",dns_start:"domainLookupStart",dns_end:"domainLookupEnd",connect_start:"connectStart",connect_end:"connectEnd",ssl_start:"secureConnectionStart",request_start:"requestStart",response_start:"responseStart",response_end:"responseEnd"},ve=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.key="navigation-radar-plus",t.logData={},t.isMainApi=!1,t.hasReportMainApi=!1,t}return t(n,e),Object.defineProperty(n.prototype,"data",{get:function(){return this.sepDimension({key:re.LOAD,value:this.logData})},enumerable:!1,configurable:!0}),n.prototype.created=function(){return i(this,void 0,void 0,(function(){return a(this,(function(e){return this.onPerfReport({custom:!0,entry:{key:"radar_init",value:null}}),[2]}))}))},n.prototype.when=function(e){if(e.custom){var t=(e.entry||{}).key;return["fmp","customPerf"].indexOf(t)>-1}return this.isMainApi=this.radar.mainApiResult.some((function(t){return t.url&&e.name===t.url})),!(!this.isMainApi||"fetch"!==e.initiatorType&&"xmlhttprequest"!==e.initiatorType||!this.radar.mainApiResult.filter((function(e){return e.url})).every((function(e){return e.catch}))||this.hasReportMainApi||(this.hasReportMainApi=!0,!this.radar.hasFmp))||!e.entryType||"navigation"===e.entryType},n.prototype.onPerfReport=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i,o,s,c,u=this;return a(this,(function(a){if(e.custom){if((t=e.entry)&&(n=t.key,r=t.value,i=e.renderTime,"radar_init"===n&&Object.assign(this.logData,{event_name:"radar_init"}),"fmp"===n&&(performance.timing.radarFmp=i,o=this.radar.generateLog(pe,performance.timing,!1),Object.assign(this.logData,((c={})[n]=r,c),{event_name:"fmp"},o)),"customPerf"===n&&(s={},Object.keys(this.radar.customPerfList).forEach((function(e){s[e+"_time"]=u.radar.customPerfList[e].time})),Object.assign(this.logData,{event_name:"h5_custom_metric",custom_metric:JSON.stringify(s),custom_metric_name:r,custom_metric_timestamp:this.radar.customPerfList[r].time}),this.radar.customPerfList[r]&&this.radar.customPerfList[r].options&&!0!==this.radar.customPerfList[r].options.sendTimeline)))return[2]}else this.isMainApi?Object.assign(this.logData,{event_name:"main_api"}):Object.assign(this.logData,{event_name:"h5_load"});return this.getCommonLog(e),this.loadReport(),[2]}))}))},n.prototype.destroy=function(){},n.prototype.getCommonLog=function(e){var t=this.radar.generateLog(le,e,!1),n=G(performance.timing,fe);Object.assign(this.logData,t,n,{main_api_list:this.radar.mainApiResult})},n.prototype.sepDimension=function(e){var t=e.key,n=e.value,i=n.protocol,a=n.event_name,o=n.custom_metric,s=n.custom_metric_name,c=n.main_api_list;return{key:t,value:r(n,["protocol","event_name","custom_metric","custom_metric_name","main_api_list"]),dimension:{protocol:i,event_name:a,custom_metric:o,custom_metric_name:s,main_api_list:c}}},n.prototype.loadReport=function(){Object.assign(this.logData,q),this.collectAndFlush()},n.prototype.collectAndFlush=function(){this.radar.logCollectNext(X(this.data)),this.radar.flushNext(),this.radar.weblog.flush()},n}(ce),ge=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.key="resource",t.onResError=function(e){t.isScriptError(e)||t.radar.logCollect(t.sepDimension({key:f.RES,value:{failed:!0,file:e.target.src,res_path:Q(e.path||e.composedPath&&e.composedPath())}}))},t}return t(n,e),n.prototype.created=function(){u(window,"error",this.onResError,!0)},n.prototype.when=function(e){return!V(e.name,this.radar.ignoreList)&&"resource"===e.entryType&&"fetch"!==e.initiatorType&&"xmlhttprequest"!==e.initiatorType},n.prototype.isScriptError=function(e){return e.message||null!=e.lineno},n.prototype.onPerfReport=function(e){var t=this.radar.generateLog(k,e);this.radar.logCollect(this.sepDimension({key:f.RES,value:t}))},n.prototype.destroy=function(){l(window,"error",this.onResError,!0)},n.prototype.sepDimension=function(e){var t=e.key,n=e.value,i=n.protocol,a=n.file,o=n.cached,s=n.res_path,c=n.failed,u=n.res_type;return{key:t,value:r(n,["protocol","file","cached","res_path","failed","res_type"]),dimension:{protocol:i,file:a,cached:o,failed:c,res_path:s,res_type:u}}},n}(ce),ye=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.key="resource",t.onResError=function(e){t.isScriptError(e)||t.radar.logCollectNext(t.sepDimension({key:re.RES,value:{failed:!0,file:e.target.src||e.target.href,res_path:Q(e.path||e.composedPath&&e.composedPath())}}))},t}return t(i,e),i.prototype.created=function(){u(window,"error",this.onResError,!0)},i.prototype.when=function(e){return!V(e.name,this.radar.ignoreList)&&("resource"===e.entryType&&"fetch"!==e.initiatorType&&"xmlhttprequest"!==e.initiatorType||"resource"===e.entryType&&("fetch"===e.initiatorType||"xmlhttprequest"===e.initiatorType)&&("js"===K(e.name)||"css"===K(e.name)))},i.prototype.isScriptError=function(e){return e.message||null!=e.lineno},i.prototype.onPerfReport=function(e){var t=this.radar.generateLog(de,e,!1),r={encoded_body_size:e.encodedBodySize+"",decoded_body_size:e.decodedBodySize+""};Object.keys(me).forEach((function(t){r[t]=Number(e[me[t]]+performance.timing.navigationStart).toFixed()})),this.radar.logCollectNext(this.sepDimension({key:re.RES,value:n(n(n({},t),r),{failed:!1})}))},i.prototype.destroy=function(){l(window,"error",this.onResError,!0)},i.prototype.sepDimension=function(e){var t=e.key,n=e.value,i=n.protocol,a=n.file,o=n.cached,s=n.res_path,c=n.failed,u=n.res_type;return{key:t,value:r(n,["protocol","file","cached","res_path","failed","res_type"]),dimension:{protocol:i,file:a,cached:o,failed:c,res_path:s,res_type:u}}},i}(ce);function _e(e){return void 0===e&&(e=""),"__radar_"+e+Math.random().toString(36).substring(2,8)}function we(e,t){var r=window.XMLHttpRequest;return r?(window.XMLHttpRequest=function(){var i=new r;i._radarRequest=Object.create(null),i._radarResponse=Object.create(null);var a=_e();i._radarRequest.id=a;var o=function(){var e,t,n,r;for(e in i._radarResponse.status=i.status,i._radarResponse.statusText=i.statusText,r=function(e,t){switch(null==t&&(t={}),typeof e){case"object":var n=[];for(var r in e){var i=e[r],a=r.toLowerCase();n.push(a+":\t"+i)}return n.join("\n")+"\n";case"string":for(var o=0,s=(n=e.split("\n")).length;o<s;o++){var c=n[o];if(/([^:]+):\s*(.+)/.test(c)){var u=RegExp.$1,l=null!=u?u.toLowerCase():void 0;i=RegExp.$2,null==t[l]&&(t[l]=i)}}return t}}(i.getAllResponseHeaders()))n=r[e],i._radarResponse&&i._radarResponse.headers&&!i._radarResponse.headers[e]&&(t=e.toLowerCase(),i._radarResponse.headers[t]=n)};if(i.addEventListener("readystatechange",(function(){switch(i.readyState){case 4:"function"==typeof t&&(o(),function(){if(i.responseType&&"text"!==i.responseType)"document"===i.responseType?(i._radarResponse.xml=i.responseXML,i._radarResponse.data=i.responseXML):i._radarResponse.data=i.response;else{i._radarResponse.text=i.responseText,i._radarResponse.data=i.responseText;try{i._radarResponse.xml=i.responseXML}catch(e){}}"responseURL"in i&&(i._radarResponse.finalUrl=i.responseURL)}(),t(i._radarRequest,i._radarResponse))}})),"function"==typeof i.open){var s=i.open;i.open=function(e,t,r,i,a){var o=[].slice.call(arguments);return this._radarRequest=n({method:e,url:t,async:r,user:i,pass:a},this._radarRequest),this._radarResponse.headers={},s.apply(this,o)}}if("function"==typeof i.send){var c=i.send;i.send=function(){var t=[].slice.call(arguments);return"function"==typeof e&&(this._radarRequest._config=t[0],e(this._radarRequest)),c.apply(this,t)}}return i},["DONE","HEADERS_RECEIVED","LOADING","OPENED","UNSENT"].forEach((function(e){window.XMLHttpRequest[e]=r[e]})),window.XMLHttpRequest.prototype=r.prototype,function(){r&&(window.XMLHttpRequest=r)}):(c("HAS NOT XMLHttpRequest!"),!1)}function be(e,t){var n=function(e){if("function"!=typeof e.fetch)return null;var t=e.fetch;return e.fetch=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Ee.apply(void 0,o([e],t))}}(e.fetch),{register:function(e){return Se.push(e),function(){var t=Se.indexOf(e);t>=0&&Se.splice(t,1)}},clear:function(){Se=[]},unRegister:function(){t&&(e.fetch=t)}}}("function"==typeof importScripts?self:window);return n&&n.register({request:function(t,n){"function"==typeof e&&e(t)},response:function(e,n){"function"==typeof t&&t(n,e)},responseError:function(e,n){"function"==typeof t&&t(n,{status:0,statusText:e})}}),null==n?void 0:n.unRegister}var Se=[],ke=["application/json","text/html","text/plain"];function Ee(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=Se.reduce((function(e,t){return[t].concat(e)}),[]),i="string"==typeof t[0]?new Request(t[0],t[1]):t[0];i.id=_e(),r.forEach((function(e){var t=e.request;i=t(i)||i}));var a=i.clone(),o=e.apply(void 0,t),s=null,c=null,u=!1;return o.then((function(e){var t=e.headers.get("content-type");if(t&&ke.some((function(e){return t.indexOf(e)>-1}))){u=!0;var n=e.clone();return s=n.clone(),n.clone().text()}return s=e,"[object Object]"})).then((function(e){c=e;try{return a.text()}catch(e){return"Radar: Request.text()失败"}})).then((function(e){i._config=e;var t=null;return u?(t=s.clone()).data=c:t=s,r.forEach((function(e){var n=e.response;n&&(t=n(t,i)||t)})),s}),(function(e){throw r.forEach((function(t){var n=t.responseError;n&&(e=n(e,i)||e)})),e}))}var xe=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.queue=[],t.key="api",t.logList=[],t.perfList=[],t.unhookXML=null,t.unhookFetch=null,t.beforeHook=function(e){if(!V(e.url,t.radar.ignoreList)&&"js"!==K(e.url)&&"css"!==K(e.url)){var n={api:t.requestURLCompletion(e.url),method:e.method,request:e,startTime:Date.now()};t.queue.push(n)}},t.afterHook=function(e,i){var a=t.queue.filter((function(t){return t.request===e}))[0];if(a){var o=ne(a.api,t.radar.mainApiList);o>-1&&!t.radar.hasFmp&&(t.radar.mainApiResult[o].url=a.api),delete a.request;var s=a.startTime,c=r(a,["startTime"]),u=Date.now(),l=u-s+"",d=i.status;"function"==typeof t.options.customizeRadarStatus&&(d=t.options.customizeRadarStatus(i));var p=t.customHook({request:e,response:i,duration:l}),h=Pe(i.headers),m=n(n({duration:l,logTime:Date.now().toString(),total:l,status:d,size:+h+"",content_type:Oe(i.headers),custom_failed:!(d>=200&&d<300)},c),p);i.finalUrl&&(m.api=i.finalUrl),"string"==typeof i.text&&(m.responseData=i.text);var v=n(n({},i),{status:d});if(t.isResponseError(v))t.radar.logCollect(t.sepDimension({key:f.API,value:m})),t.radar.logCollectNext(t.sepDimension({key:f.API,value:m}));else{if(!t.radar.hasFmp){var g=performance.timing.apiStart;performance.timing.apiStart=g?Math.min(g,s):s;var y=performance.timing.apiEnd;performance.timing.apiEnd=y?Math.max(y,u):u}!t.mergeAPIPerf(null,m)&&t.logList.push(m)}t.queue=t.queue.filter((function(t){return t.request&&t.request!==e}))}},t}return t(i,e),i.prototype.when=function(e){return!V(e.name,this.radar.ignoreList)&&"resource"===e.entryType&&("fetch"===e.initiatorType||"xmlhttprequest"===e.initiatorType)&&"js"!==K(e.name)&&"css"!==K(e.name)},i.prototype.onPerfReport=function(e){var t=this.radar.generateLog(S,e,!1);t.perfTime=Date.now().toString();var r={encoded_body_size:e.encodedBodySize&&e.encodedBodySize+"",decoded_body_size:e.decodedBodySize&&e.decodedBodySize+""};Object.keys(he).forEach((function(t){r[t]=Number(e[he[t]]+performance.timing.navigationStart).toFixed()}));var i=n(n({},t),{api:t.file,apiTime:r});!this.mergeAPIPerf(i)&&this.perfList.push(i)},i.prototype.mergeAPIPerf=function(e,t){var r=e||t,i=e?this.logList:this.perfList;if(!r)return!1;for(var a=-1,o=0,s=i.length;o<s;o++){var c=i[o],u=(r.api||"").replace(/\?.+$/,""),l=(c.api||"").replace(/\?.+$/,""),d=r.size;if(u===l){Object.assign(r,c);var h=ne(u,this.radar.mainApiList);h>-1&&!0!==this.radar.mainApiResult[h].catch&&(this.radar.mainApiResult[h]=n(n({},r.apiTime),{url:r.api,status:r.status,size_radar:r.size,cached:r.cached,method:r.method,catch:!0,perfTime:r.perfTime})),Object.assign(r,r.apiTime),delete r.file,d&&(r.size=d),!r.size&&r.responseData&&(r.size=p(r.responseData)),delete r.responseData,a=o}}return-1!==a&&(i.splice(a,1),this.radar.logCollect(this.sepDimension({key:f.API,value:r})),this.radar.logCollectNext(this.sepDimension(X({key:f.API,value:r}))),!0)},i.prototype.sepDimension=function(e){var t=e.key,n=e.value,i=n.res_type,a=n.protocol,o=n.cached,s=n.custom_failed,c=n.content_type,u=n.broadcast_info,l=n.status,d=n.api,p=n.method,f=n.response_code,h=n.response_msg;return n.apiTime,{key:t,value:r(n,["res_type","protocol","cached","custom_failed","content_type","broadcast_info","status","api","method","response_code","response_msg","apiTime"]),dimension:{res_type:i,protocol:a,api:d,custom_failed:s,content_type:c,status:l,cached:o,method:p,response_code:f,response_msg:h,broadcast_info:u}}},i.prototype.requestURLCompletion=function(e){var t=document.location,n=t.protocol,r=t.host;return 0===e.indexOf("//")?n+e:0===e.indexOf("/")?n+"//"+r+e:e},i.prototype.isResponseError=function(e){return 0===e.status},i.prototype.created=function(){this.unhookXML=we(this.beforeHook,this.afterHook),this.unhookFetch=be(this.beforeHook,this.afterHook)},i.prototype.destroy=function(){this.unhookXML&&this.unhookXML(),this.unhookFetch&&this.unhookFetch()},i.prototype.customHook=function(e){var t={};if("function"!=typeof this.options.APIHook)return t;var n={};try{n=this.options.APIHook(e)}catch(e){return{}}if(!n)return t;var r=n.response_msg,i=n.response_code,a=n.status,o=n.custom_failed,s=n.broadcast_info;try{t.response_msg=JSON.stringify(r).slice(0,100)}catch(e){t.response_msg="radar error: 传入的response_msg有错误"}return t.response_code=Number(i),void 0!==a&&(t.status=a),void 0!==o&&(t.custom_failed=o),t.broadcast_info=s,t},i}(ce);function Oe(e){return e?"function"==typeof e.get?e.get("Content-Type"):e["content-type"]:null}function Pe(e){return e?"function"==typeof e.get?+e.get("Content-Length")||0:+e["content-length"]||0:0}var Te=[];function Ie(e,t){Le(t)>=0||(Te.push(t),setTimeout((function(){Te.splice(Le(t),1)}),2e3),Ce(e,t))}function Ce(e,t){var n=function(e){var t=f.ERROR,n=e.error_cons_type,i=e.file,a=e.error_type,o=e.msg,s=e.col,c=e.line,u=e.stack;return{key:t,value:r(e,["error_cons_type","file","error_type","msg","col","line","stack"]),dimension:{error_cons_type:n,file:i,error_type:a,msg:o,col:s,line:c,stack:u}}}(t);e.logCollect(n)}function Le(e){for(var t=0;t<Te.length;t++)if(r=e,(n=Te[t]).msg===r.msg&&n.stack===r.stack&&n.file===r.file&&n.line===r.line&&n.col===r.col)return t;var n,r;return-1}function Ae(e){return e.message||null!=e.lineno}function Ne(e,t,n){var r,i,a,o;return(o=t)&&(o instanceof Error||"object"==typeof o&&"string"==typeof o.message)?(r=t.name||"ErrorLikeObject",i=t.message||"",a=t.stack||void 0):function(e,t){return null==e&&"Script error."===(null==t?void 0:t.message)}(t,n)?(r="CrossOriginError",i="* cross origin "+e+" with message: "+((null==n?void 0:n.message)||"<UNKNOWN>")+"\n -- by WebLogger Radar Plugin"):(r=null==t?""+t:typeof t,i="* "+e+" with value: "+function(e){var t;try{t=e.toString()}catch(e){}return"string"!=typeof t||""===t?t=null===e?"<NULL>":void 0===e?"<UNDEFINED>":""===t?"<EMPTY>":"<UNKNOWN>":t.length>2e3&&(t=t.substring(0,2e3)+"<<< ……"),t}(t)+"\n  -- by WebLogger Radar Plugin"),{error_type:m.SCRIPT,error_cons_type:r,msg:i,stack:a}}var Re=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.key="error",t.onError=function(e){if(Ae(e)){var r=n(n({},Ne("global error",e.error,e)),{file:e.filename,line:e.lineno,col:e.colno});Ie(t.radar,r)}},t.onPromiseError=function(e){var n=Ne("promise error",e.reason);Ie(t.radar,n)},t}return t(r,e),r.prototype.when=function(e){if(e.custom){var t=(e.entry||{}).key;if(["play_block","play_error"].indexOf(t)>-1)return!0}return!1},r.prototype.onPerfReport=function(e){if(e.custom){var t=e.entry||{},n=t.key,r=t.value;Ce(this.radar,{error_type:m.VIDEO,error_cons_type:n,msg:r})}},r.prototype.created=function(){u(window,"error",this.onError,!0),u(window,"unhandledrejection",this.onPromiseError)},r.prototype.destroy=function(){l(window,"error",this.onError,!0),l(window,"unhandledrejection",this.onPromiseError)},r}(ce),De=[];function je(e,t){Ue(t)>=0||(De.push(t),setTimeout((function(){De.splice(Ue(t),1)}),2e3),Me(e,t))}function Me(e,t){var n=function(e){var t=re.ERROR,n=e.error_cons_type,i=e.file,a=e.error_type,o=e.msg,s=e.col,c=e.line,u=e.stack;return{key:t,value:r(e,["error_cons_type","file","error_type","msg","col","line","stack"]),dimension:{error_cons_type:n,file:i,error_type:a,msg:o,col:s,line:c,stack:u}}}(t);e.logCollectNext(n)}function Ue(e){for(var t=0;t<De.length;t++)if(r=e,(n=De[t]).msg===r.msg&&n.stack===r.stack&&n.file===r.file&&n.line===r.line&&n.col===r.col)return t;var n,r;return-1}function Be(e){return e.message||null!=e.lineno}function Ke(e,t,n){var r,i,a,o;return(o=t)&&(o instanceof Error||"object"==typeof o&&"string"==typeof o.message)?(r=t.name||"ErrorLikeObject",i=t.message||"",a=t.stack||void 0):function(e,t){return null==e&&"Script error."===(null==t?void 0:t.message)}(t,n)?(r="CrossOriginError",i=e+" - message: "+((null==n?void 0:n.message)||"<UNKNOWN>")):null===t&&(null==n?void 0:n.message)&&"Uncaught null"!==n.message?(r="Error",i=e+" - message: "+n.message):(r=null==t?""+t:typeof t,i=e+" - value: "+function(e){var t;try{t=e.toString()}catch(e){}return"string"!=typeof t||""===t?t=null===e?"<NULL>":void 0===e?"<UNDEFINED>":""===t?"<EMPTY>":"<UNKNOWN>":t.length>2e3&&(t=t.substring(0,2e3)+"<<< ……"),t}(t)),{error_type:ie.SCRIPT,error_cons_type:r,msg:i,stack:a}}var Ve=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.key="error",t.onError=function(e){if(Be(e)){var r=n(n({},Ke("Global Uncaught Exception",e.error,e)),{file:e.filename,line:e.lineno,col:e.colno});je(t.radar,r)}},t.onPromiseError=function(e){var n=Ke("Unhandled Promise Rejection",e.reason);je(t.radar,n)},t}return t(r,e),r.prototype.when=function(e){if(e.custom){var t=(e.entry||{}).key;if(["play_block","play_error"].indexOf(t)>-1)return!0}return!1},r.prototype.onPerfReport=function(e){if(e.custom){var t=e.entry||{},n=t.key,r=t.value;Me(this.radar,{error_type:ie.VIDEO,error_cons_type:n,msg:r})}},r.prototype.created=function(){u(window,"error",this.onError,!0),u(window,"unhandledrejection",this.onPromiseError)},r.prototype.destroy=function(){l(window,"error",this.onError,!0),l(window,"unhandledrejection",this.onPromiseError)},r}(ce),We=["play_block","play_error"],Fe=["c_dimension1","c_dimension2","c_dimension3"],qe=["main_data_receive_end"];return function(e){function n(t,n){var r,i=e.call(this,t,n)||this;return i.radarIgnoreList=["https://web-trace.ksapisrv.com/ktrace/collect"],i.radarFmp=0,i.customReported=[],i.customKeyList=[],i.timelineLastTime=null,i.action={start:function(e){te(e),i.event({name:e.name,extra_info:e.extra_info||"",event_type:"radar_action_start"})},end:function(e){te(e),i.event({name:e.name,extra_info:e.extra_info||"",result_type:e.result_type||"",event_type:"radar_action_end"})}},i.validOption()?((null===(r=i.options)||void 0===r?void 0:r.customDimensions)&&i.setDimensions(i.options.customDimensions),i.options&&i.options.unuseResourcePlugin||(i.use(ge,i),i.use(ye,i)),i.options&&i.options.unuseAPIPlugin||i.use(xe,i),i.options&&i.options.unuseErrorPlugin||(i.use(Re,i),i.use(Ve,i)),i.use(ue,i),i.use(ve,i),i):i}return t(n,e),n.samplingControl=function(e){if(!e)return!1;var t=Math.random();return"number"==typeof e?t<e:t<e.sampling},n.prototype.collect=function(e,t){if(0!==e.indexOf("c_")&&qe.indexOf(e)<0)c("[error 305]","[Radar] 传入的自定义指标 "+e+" 必须为 c_ 开头");else if(qe.indexOf(e)>-1)this.handleCollectKey(e);else{s("[radar]:Radar+之后将不再支持collect方法，请用event方法替代。");var n={key:f.CUSTOM,value:{metric_value:t},dimension:{metric_name:e}};this.logCollect(n),this.logCollectNext({key:f.EVENT,value:{duration:t},dimension:{name:e}})}},n.prototype.handleCollectKey=function(e){switch(e){case"main_data_receive_end":var t=Date.now();try{performance.timing&&(performance.timing[e]=t)}catch(e){}H(e,t)}},n.prototype.reportTimePoint=function(e,t){if(this.customReported.indexOf(e)>-1)return null;-1===We.indexOf(e)&&this.customReported.push(e);var n=t;if("string"!=typeof t){var r=function(e){var t="undefined"!=typeof window?window.performance:null;if(!t)return{value:null};if(null!=e)return{value:e-t.timing.navigationStart,detail:{start:"navigationStart",startPoint:t.timing.navigationStart,end:"customTime",endPoint:e}};if("function"==typeof t.now)return{value:t.now(),detail:{start:"navigationStart",startPoint:t.timing.navigationStart,end:"perfNowAPI",endPoint:t.now()}};var n=Date.now();return{value:n-t.timing.navigationStart,detail:{start:"navigationStart",startPoint:t.timing.navigationStart,end:"dateNow",endPoint:n}}}(t);if(null==r.value)return;n=this.throttle(r.value,r.detail,"fmp",r.detail)}return null!=n?(this.reportPerformance({custom:!0,entry:{key:e,value:n},renderTime:t}),n):void 0},n.prototype.fmp=function(e){if(e&&"number"!=typeof e)c("[radar]: fmp方法入参请传时间戳，或选择不传！");else{this.radarFmp=e||Date.now();var t=this.reportTimePoint("fmp",this.radarFmp);if(t){this.hasFmp=!0;try{performance.timing&&(performance.timing.fmp=t,performance.timing.radarFmp=this.radarFmp)}catch(e){}H("fmp",t);var n={key:f.CUSTOM,value:{fmp:t,fmp_time:this.radarFmp,merge:!0}};this.logCollect(n),this.logCollectNext({key:f.EVENT,value:{duration:t},dimension:{name:"fmp"}})}}},n.prototype.event=function(e,t){if(e&&e.name)if("string"==typeof e.name){e.name.length>127&&(c("[radar]:事件名称长度不能超过127字符，超过会截取后上报，请限制"),e.name=e.name.slice(0,127));var n=z();e.extra_info&&e.extra_info instanceof Object&&(e.extra_info=JSON.stringify(e.extra_info)),void 0===e.yoda_version&&(e.yoda_version=n.Yoda||""),void 0===e.webview_type&&(e.webview_type=Y());var r={key:f.EVENT,value:t,dimension:e};this.logCollect(r),this.logCollectNext(r)}else c("[radar]:name字段需要为String类型");else c("[radar]:事件名称为必填字段，用于监控展示、报警配置，请填写")},n.prototype.customStage=function(e,t){if(!(this.customKeyList.length>2)){if(t=t||{sendTimeline:!0},this.customKeyList.indexOf(e)>-1)return null;this.customKeyList.push(e);var n=Date.now();"production"!==this.weblog.logConfig.env&&(this.timelineLastTime?this.timelineLastTime:this.timelineLastTime=n),this.customPerfList[e]={options:t,time:n},this.reportPerformance({custom:!0,entry:{key:"customPerf",value:e},renderTime:n})}},n.prototype.headlessTestReport=function(){-1===window.navigator.userAgent.indexOf("headless")||this.asyncReportTiming()},n.prototype.playClicked=function(e){this.reportTimePoint("play_clicked",e)},n.prototype.playIDR=function(e){this.reportTimePoint("play_idr",e)},n.prototype.playBlock=function(e){this.reportTimePoint("play_block",e)},n.prototype.playError=function(e){this.reportTimePoint("play_error",e)},n.prototype.setDimensions=function(e){var t=this,n=Object.keys(e);n.some((function(e){return-1===Fe.indexOf(e)}))&&c("[error 306]","[Radar] 传入的自定义维度只能为 "+Fe.join("、")+"，目前传入的是："+n.join("、")),n.forEach((function(n){var r=n;null==e[r]?delete t.customDimension[r]:t.customDimension[r]=e[r]}))},n.prototype.validOption=function(){var e=this;if(!this.options)return!1;var t=this.options,n=t.sampling;return"string"!=typeof t.projectId?(c("[error 303]","[Radar] 必须配置 projectId 属性，类型为 string!"),!1):n>1||n<0?(c("[error 304]","[Radar] 采样率 sampling 必须为 0~1 之间的数字"),!1):(["apiSampling","errorSampling","resourceSampling","customSampling","eventSampling"].forEach((function(t){var n=e.options[t];"number"==typeof n&&0===n&&c("[error 304]","[Radar] 采样率 "+t+" 不能被设置为 0，将改用默认值")})),!0)},n.prototype.captureException=function(e){Ie(this,Ne("capture exception",e)),je(this,Ke("Captured Exception",e))},n.__test__={MORE_REPORTED:We,CUSTOM_DIM_KEY:Fe,CUSTOM_COLLECT_KEY:qe},n.key="radar",n}(se)}()},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ReportService=void 0;var i=n(6),a=n(3),o=n(2),s=n(0),c=n(1),u=function(){var e=this;this.xhrService=i.xhrService,this.report=function(t,n,i){e.xhrService.post(t,n).then((function(e){var t=e;"object"!=typeof e&&(t=JSON.parse(e));var u=t.result,l=t.message;if(1===u){var d=JSON.stringify(r(r({},i),{data:n,message:l,resData:t,kwaiAdInfoSource:(0,c.readVal)(s.KWAI_CALLBACK_SOURCE),referrer:document.referrer}));(0,a.logUp)({name:o.LoggerTypesName.successUp,extra_info:d})}else d=JSON.stringify(r(r({},i),{data:n,message:l,resData:t,kwaiAdInfoSource:(0,c.readVal)(s.KWAI_CALLBACK_SOURCE),referrer:document.referrer})),(0,a.logUp)({name:o.LoggerTypesName.successUpForOther,extra_info:d})})).catch((function(e){var t=JSON.stringify(r(r({},i),{data:n,error:e}));(0,a.logErr)({name:o.LoggerTypesName.errUp,extra_info:t})}))}};t.ReportService=u},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.KwaiPixel=void 0;var a=n(0),o=n(6),s=n(5),c=n(31),u=n(3),l=n(2),d=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.currentHref="",r}return i(t,e),t.prototype.getInstance=function(){var e=this;return this.instancePromise||(this.instancePromise=o.xhrService.get(a.API.GET_PIXEL+"?pixelId="+this.pixelId),this.instancePromise.then((function(t){(0,u.logFMP)(),(0,u.logWC)();var n=t.status,r=t.message,i=void 0===r?"":r,a=t.data;if(200!==n)e.instancePromise=null;else if(200===n&&a){var o=JSON.stringify({data:a,message:i});(0,u.logUp)({name:l.LoggerTypesName.successConfig,extra_info:o});var c=JSON.parse(a);(0,s.getWorkspace)().instance(e.pixelId).setPixelInfo(c)}})).catch((function(t){var n=JSON.stringify({pixelId:e.pixelId,accessMode:e.accessMode,currentHref:e.currentHref,error:t});(0,u.logErr)({name:l.LoggerTypesName.errConfig,extra_info:n}),e.instancePromise=null}))),this.instancePromise},t.prototype.page=function(e){window.location.href!==this.currentHref&&(this.track(a.PAGE_VIEW_EVENT_NAME,e),this.currentHref=window.location.href)},t}(c.Pixel);t.KwaiPixel=d},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Pixel=void 0;var a=n(0),o=n(1),s=function(){function e(e,t){this.pixelId=e,this.context=t,this.loaded=!1,this.accessMode=1,this.instancePromise=this.getInstance()}return e.prototype.track=function(e,t,n){var r=this;this.getInstance().then((function(){n&&n!==r.accessMode||!n&&2===r.accessMode||r.context.track(r.pixelId,e,t,a.REPORT_TYPE.TRACK,n)}))},e.prototype.setPixelInfo=function(e){var t,n,r;if(2===e.accessMode&&(null===(r=null===(n=null===(t=this.context)||void 0===t?void 0:t.data)||void 0===n?void 0:n.adInfo)||void 0===r?void 0:r.pixelId)==e.pixelId&&(this.accessMode=e.accessMode),2===e.accessMode&&e.eventData&&Array.isArray(e.eventData)&&e.eventData.length>0)for(var i=0;i<e.eventData.length;i++)e.eventData[i].traceContent=JSON.parse(e.eventData[i].traceContent),this.initPixel(e.eventData[i])},e.prototype.initPixel=function(e){var t=e.eventType,n=e.traceMethod,r=e.traceContent;if(1===n)for(var i=0;i<r[0].destination.length;i++)window.location.href.indexOf(r[0].destination[i])>-1&&this.track(a.EVENT_NAME_FORMAT[t],e,2);else this.bindEvents(e.traceContent[0].destination,e.traceContent[0].traceUrl,t,e)},e.prototype.bindEvents=function(e,t,n,s){return r(this,void 0,void 0,(function(){var r;return i(this,(function(i){return r=this,e.forEach((function(e){var i=document.querySelector(e);window.location.href.split("?")[0];(0,o.getUrlIn)(window.location.href,t)&&i&&i.addEventListener("click",(function(){r.track(a.EVENT_NAME_FORMAT[n],s,2)}),!0)})),[2]}))}))},e}();t.Pixel=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Manager=void 0;var r=function(e){var t=this;this.loadPixel=function(e){if(!t.context.getPixel(e)){var n=t.createPixel(e);t.context.addPixel(n)}},this.setPageInfo=function(e,n){t.context.setPageInfo(e,n)},this.usePlugin=function(e){try{var n=new e(t.context);t.context.usePlugin(n)}catch(e){}},this.useDynamicPlugin=function(e){try{var n=e(t.context);t.context.usePlugin(n)}catch(e){}},this.instance=function(e){var n=t.context.getPixel(e);if(n)return n},this.instances=function(){return t.context.getAllPixels()},this.page=function(e){t.instances().forEach((function(t){return t.page(e)}))},this.track=function(e,n){t.instances().forEach((function(t){return t.track(e,n)}))},this.initialize=!0,this.context=e};t.Manager=r}])}));